window.__require=function t(e,n,i){function o(s,c){if(!n[s]){if(!e[s]){var a=s.split("/");if(a=a[a.length-1],!e[a]){var h="function"==typeof __require&&__require;if(!c&&h)return h(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){return o(e[s][1][t]||t)},u,u.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<i.length;s++)o(i[s]);return o}({AudioManager:[function(t,e,n){"use strict";cc._RF.push(e,"5c6413daoZNDbuGkk1xqW8n","AudioManager");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../utils/SingletonNode"),s=cc._decorator,c=s.ccclass,a=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){},e=o([c],e)}(r.default()));n.default=a,cc._RF.pop()},{"../utils/SingletonNode":"SingletonNode"}],BGLoop:[function(t,e,n){"use strict";cc._RF.push(e,"00f12BxhR5A0YuizFtOVf1B","BGLoop");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameMgr"),s=t("./EnviromentManager"),c=cc._decorator,a=c.ccclass,h=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=1,e.canMove=!1,e.canvasWidth=0,e}return i(e,t),e.prototype.start=function(){this.canvasWidth=1920,this.speed=s.default.Instance.changeEnvSpeed,this.InitPos()},e.prototype.update=function(t){if(!r.default.Instance.IsPause()&&this.canMove){var e=this.speed;s.default.Instance.isChangingEnviroment&&(e=0);for(var n=e*t*1,i=0,o=this.node.children;i<o.length;i++){var c=o[i];c.x-=n,c.x<-c.width/2-this.canvasWidth/2&&(c.x+=this.node.children.length*c.width)}}},e.prototype.InitPos=function(){for(var t=0;t<this.node.children.length;t++){this.node.children[t].setPosition(new cc.Vec2(-this.canvasWidth/2+(t+.5)*this.node.children[t].width,0))}},o([h(Number)],e.prototype,"speed",void 0),e=o([a],e)}(cc.Component);n.default=u,cc._RF.pop()},{"./EnviromentManager":"EnviromentManager","./GameMgr":"GameMgr"}],BackgroundFade:[function(t,e,n){"use strict";cc._RF.push(e,"d99632dB5RLc78CGdi+FEQc","BackgroundFade");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameDefine"),s=t("./GameMgr"),c=t("./MiddleGround"),a=t("../utils/SingletonNode"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Desert=null,e.Mix=null,e.City=null,e.isSwitching=!1,e.currentMode=null,e.nextMode=null,e.totalDistance=0,e.canvasWidth=0,e}return i(e,t),e.prototype.start=function(){this.currentMode=this.Desert,this.canvasWidth=s.default.Instance.CanvasWidth,this.InitPos()},e.prototype.update=function(t){if(this.isSwitching){var e=r.default.SPEED_PLAYER_NORMAL*t*1;this.totalDistance+=e;for(var n=0,i=this.node.children;n<i.length;n++){var o=i[n];o.x-=e,o.x<-(this.canvasWidth-10)&&(o.x+=2*(this.canvasWidth-10),0==this.node.children.indexOf(o)&&(o.getComponent(cc.Sprite).spriteFrame=this.nextMode))}this.totalDistance>=2*(this.canvasWidth-10)&&(this.isSwitching=!1,console.log("done"))}},e.prototype.InitPos=function(){for(var t=0;t<this.node.children.length;t++){var e=this.node.children[t];e.width=this.node.width,e.height=this.node.height,e.setPosition(new cc.Vec2(t*this.canvasWidth-10*t,0)),console.log(e.x)}},e.prototype.swtichBackground=function(){console.log("switchinggg...."),this.isSwitching=!0,this.totalDistance=0;var t=this.node.children[1];this.currentMode==this.Desert?(this.currentMode=this.City,t.setScale(1,1),this.nextMode=this.City):(this.currentMode=this.Desert,t.setScale(-1,1),this.nextMode=this.Desert),c.default.Instance.changeBackground()},o([p(cc.SpriteFrame)],e.prototype,"Desert",void 0),o([p(cc.SpriteFrame)],e.prototype,"Mix",void 0),o([p(cc.SpriteFrame)],e.prototype,"City",void 0),e=o([u],e)}(a.default());n.default=d,cc._RF.pop()},{"../utils/SingletonNode":"SingletonNode","./GameDefine":"GameDefine","./GameMgr":"GameMgr","./MiddleGround":"MiddleGround"}],Bg:[function(t,e,n){"use strict";cc._RF.push(e,"6fb92hSk7VMY7ll3ps/Qt5Z","Bg");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameMgr"),s=cc._decorator,c=s.ccclass,a=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mX=0,e.speed=0,e}return i(e,t),e.prototype.onLoad=function(){this.init(),this.Camera=r.default.Instance.Camera},e.prototype.start=function(){},e.prototype.update=function(t){if(!r.default.Instance.IsPause()){for(var e=-this.speed*t,n=0;n<this.node.children.length;n++)this.node.children[n].setPosition(this.node.children[n].position.add(new cc.Vec3(e,0,0)));for(n=0;n<this.node.children.length;n++)this.node.children[n].x<-this.node.children[n].width&&this.node.children[n].setPosition(this.node.children[n].position.add(new cc.Vec3(this.node.children.length*r.default.Instance.CanvasWidth,0,0)))}},e.prototype.init=function(){this.mX=0;for(var t=this.node.children[0].width,e=0;e<this.node.children.length;e++)this.node.children[e].x=0+e*t},o([a(Number)],e.prototype,"speed",void 0),e=o([c],e)}(cc.Component);n.default=h,cc._RF.pop()},{"./GameMgr":"GameMgr"}],BigBg:[function(t,e,n){"use strict";cc._RF.push(e,"45b56grJgtMepdiIfpgO5rx","BigBg");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameDefine"),s=t("./GameMgr"),c=cc._decorator,a=c.ccclass,h=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgWidth=0,e.speed=1,e.isDecor=!1,e.isForeGround=!1,e}return i(e,t),e.prototype.start=function(){this.setupPos(),this.speed=r.default.SPEED_PLAYER_NORMAL/this.speed},e.prototype.setupPos=function(){this.isDecor?this.bgWidth=this.getWidth():this.bgWidth=this.node.children[0].width;for(var t=0;t<this.node.children.length;t++)this.node.children[t].setPosition(new cc.Vec2(t*this.bgWidth,this.node.children[t].position.y))},e.prototype.update=function(t){if(!s.default.Instance.IsPause()){for(var e=0,n=this.node.children;e<n.length;e++){(r=n[e]).setPosition(r.position.add(new cc.Vec3(-this.speed*t,0,0)))}for(var i=0,o=this.node.children;i<o.length;i++){var r;(r=o[i]).position.x<-this.bgWidth-20&&r.setPosition(r.position.add(new cc.Vec3(this.node.children.length*this.bgWidth,0,0)))}}},e.prototype.getWidth=function(){var t=this.node.children[0],e=t.children[t.children.length-1];return e.x+e.width},o([h(Number)],e.prototype,"speed",void 0),o([h(cc.Boolean)],e.prototype,"isDecor",void 0),o([h(cc.Boolean)],e.prototype,"isForeGround",void 0),e=o([a],e)}(cc.Component);n.default=u,cc._RF.pop()},{"./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],Decoration:[function(t,e,n){"use strict";cc._RF.push(e,"117eaJpLfZDroxrzHTqiVSy","Decoration");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameDefine"),s=t("./GameMgr"),c=t("../utils/SingletonNode"),a=t("../utils/Helper"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.decor_desert=[],e.decor_city=[],e.decor_beach=[],e.speed=1,e.currentMode=0,e.currenDecorSet=[],e.canvasWidth=0,e.isStopSpawn=!1,e.totalWidth=0,e}return i(e,t),e.prototype.start=function(){this.speed=r.default.SPEED_PLAYER_NORMAL/this.speed,this.currenDecorSet=this.decor_desert,this.canvasWidth=s.default.Instance.CanvasWidth},e.prototype.update=function(t){if(!s.default.Instance.IsPause())for(var e=this.speed*t*1,n=0,i=this.node.children;n<i.length;n++){var o=i[n];o.x-=e,o.x<-this.canvasWidth/2&&(o.destroy(),this.totalWidth-=this.canvasWidth/2)}},e.prototype.spawnNewDecor=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);for(var n=0;n<e;n++){var i=a.default.RandInt(0,this.currenDecorSet.length-1),o=this.currenDecorSet[i],r=cc.instantiate(o);this.node.addChild(r);r.setPosition(new cc.Vec2(t+n*this.canvasWidth/2)),this.totalWidth+=this.canvasWidth/2}},e.prototype.getPos=function(){return this.node.children[this.node.children.length-1].x+this.canvasWidth/2},e.prototype.stopSpawn=function(t){void 0===t&&(t=!0),this.isStopSpawn=t},e.prototype.changeBackground=function(t){this.currenDecorSet==this.decor_desert?this.currenDecorSet=this.decor_city:this.currenDecorSet==this.decor_city?this.currenDecorSet=this.decor_beach:this.currenDecorSet=this.decor_desert},o([p([cc.Prefab])],e.prototype,"decor_desert",void 0),o([p([cc.Prefab])],e.prototype,"decor_city",void 0),o([p([cc.Prefab])],e.prototype,"decor_beach",void 0),o([p(Number)],e.prototype,"speed",void 0),e=o([u],e)}(c.default());n.default=d,cc._RF.pop()},{"../utils/Helper":"Helper","../utils/SingletonNode":"SingletonNode","./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],Effect:[function(t,e,n){"use strict";cc._RF.push(e,"c6211HunWRKg7DWtwBohQOp","Effect");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.EffectType=void 0;var r,s=t("./GameDefine"),c=t("./GameMgr"),a=cc._decorator,h=a.ccclass,u=a.property;(function(t){t[t.XP=0]="XP"})(r=n.EffectType||(n.EffectType={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=r.XP,e.speed=0,e}return i(e,t),e.prototype.start=function(){},e.prototype.action=function(t,e,n){void 0===t&&(t=null),void 0===e&&(e=0),void 0===n&&(n=0),this.node.setScale(0),this.direct=new cc.Vec2(1,1),this.speed=s.default.SPEED_PLAYER_NORMAL;var i=t.position,o=t.parent.position;this.target=new cc.Vec3(i.x+o.x+e/2,i.y+o.y+n/2,0),this.setAction()},e.prototype.update=function(t){},e.prototype.setAction=function(){var t=this;switch(this.type){case r.XP:cc.tween(this.node).by(.5,{scale:1.5},{easing:"bounceOut"}).to(1,{scale:1,position:this.target},{easing:"quadOut"}).call(function(){c.default.Instance.Player.killEnemy(1),setTimeout(function(){t.node.destroy()},200)}).start()}},o([u({type:cc.Enum(r)})],e.prototype,"type",void 0),e=o([h],e)}(cc.Component);n.default=p,cc._RF.pop()},{"./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],EnemyDefine:[function(t,e,n){"use strict";cc._RF.push(e,"addcajwU8NNPZ+WVvAT1DVG","EnemyDefine"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=new(function(){return function(){this.DEFAULT=[],this.BOOSTER=[],this.DEFAULT_CROW=[2.5,3.8,5.4,6.1,7.5,7.8,9.1,9.2,10.3,10.3,11.3,11.1,12,11.9,12.7,12.5,13.3,13,13.8,13.5,14.2,13.9,14.5,14.3,14.9,14.6,15.1,14.9,15.4,15.1],this.DEFAULT_SNAKE=[4,5,6.7,7.1,8.6,8.8,10,10,11.1,11,12,11.8,12.7,12.5,13.3,13.1,13.8,13.6,14.3,14,14.7,14.4,15,14.7,15.3,15,15.6,15.3,15.8,15.5],this.DEFAULT_SPIDER=[5,6.7,9.2,10,12.1,12.5,14.4,14.4,16.1,16,17.5,17.3,18.6,18.3,19.6,19.2,20.4,20,21.1,20.7,21.7,21.3,22.2,21.8,22.6,22.2,23.1,22.6,23.4,23],this.BOOSTER_CROW=[1.3,2,3,3.5,4.4,4.8,5.6,5.9,6.6,6.8,7.5,7.7,8.3,8.4,9,9,9.6,9.6,10.1,10.1,10.6,10.6,11.1,11,11.5,11.4,11.8,11.8,12.2,12.1],this.BOOSTER_SNAKE=[2,2.7,3.6,4.2,5,5.4,6.2,6.4,7.1,7.3,8,8.1,8.8,8.8,9.4,9.4,10,10,10.5,10.5,11,11,11.4,11.4,11.8,11.7,12.2,12.1,12.5,12.4],this.BOOSTER_SPIDER=[2.5,3.6,5,5.8,7.1,7.7,8.8,9.3,10.4,10.7,11.7,11.9,12.8,12.9,13.8,13.9,14.7,14.7,15.5,15.5,16.3,16.2,16.9,16.8,17.5,17.4,18,17.9,18.5,18.4],this.DEFAULT=[this.DEFAULT_SPIDER,this.DEFAULT_CROW,this.DEFAULT_SNAKE],this.BOOSTER=[this.BOOSTER_SPIDER,this.BOOSTER_CROW,this.BOOSTER_SNAKE]}}()),cc._RF.pop()},{}],EnemyMgr:[function(t,e,n){"use strict";cc._RF.push(e,"a0f9426HglJfpeVxzzRf0ww","EnemyMgr");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.EnemyTypes=void 0;var r,s=t("./GameDefine"),c=t("./Enemy"),a=t("./GameMgr"),h=t("../utils/Helper"),u=cc._decorator,p=u.ccclass,d=u.property;(function(t){t[t.SPIDER=0]="SPIDER",t[t.CROW=1]="CROW",t[t.SNAKE=2]="SNAKE",t[t.OWL=3]="OWL"})(r=n.EnemyTypes||(n.EnemyTypes={}));var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Prefabs=[],e.Player=null,e}return i(e,t),e.prototype.load=function(){},e.prototype.onLoad=function(){this.load()},e.prototype.spawnEnemy=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=r.SPIDER);var n=this.Prefabs[0],i=0,o=0;switch(t?h.default.RandInt(0,2):e){case r.SPIDER:n=this.Prefabs[0],i=a.default.Instance.CanvasWidth/2,o=a.default.Instance.CanvasHeight+100;break;case r.CROW:n=this.Prefabs[1],i=a.default.Instance.CanvasWidth+100,o=a.default.Instance.CanvasHeight+100;break;case r.SNAKE:n=this.Prefabs[2],i=a.default.Instance.CanvasWidth+100,o=a.default.Instance.Player.node.y}var s=cc.instantiate(n);this.node.addChild(s),s.setPosition(new cc.Vec3(i,o,0)),s.getComponent(c.default).init()},e.prototype.start=function(){var t=this;this.Player=a.default.Instance.Player,setTimeout(function(){t.spawnEnemy(!1,r.SNAKE)},2e3),setTimeout(function(){t.spawnEnemy(!0)},1e3)},e.prototype.update=function(t){this.node.setPosition(this.node.position.add(new cc.Vec3(-s.default.SPEED_PLAYER_NORMAL*t,0,0)))},o([d([cc.Prefab])],e.prototype,"Prefabs",void 0),e=o([p],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../utils/Helper":"Helper","./Enemy":"Enemy","./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],Enemy:[function(t,e,n){"use strict";cc._RF.push(e,"105a9o6FMpCgoTKV756TzYJ","Enemy");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./EnemyMgr"),s=t("./GameMgr"),c=t("./GameDefine"),a=t("./EnemyDefine"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=r.EnemyTypes.SPIDER,e.isBoss=!1,e.UI_HP_BAR=null,e.UI_HP_BAR_FILL=null,e.glowBoss=null,e.Spine=null,e.State={IDLE:0,HURT:1,KILL:2,WAIT:3},e.state=0,e.speed=0,e.gravity=0,e.isTouchDown=!1,e.mHp=0,e.Player=null,e.isActive=!1,e.mExp=0,e.UI_HP=null,e.initHP=0,e.score=0,e.direct=null,e.previousSpeed=0,e.currentTrack=null,e.currentAnim="",e.previousAnim="",e.rigidboy=null,e.isPlayedBossSound=!1,e.atk=0,e.isClaimReward=!1,e.animSet={Attack:"Attack_Animation",Be_Attacked:"Be_attacked_Animation",Death:"Die_Animation",Move:"Attack_Animation"},e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.Player=s.default.Instance.Player,this.setPositionInit(),this.init(),this.setState(this.State.IDLE),this.setCompleteAnimEvent(),this.rigidboy=this.getComponent(cc.RigidBody)},e.prototype.setCompleteAnimEvent=function(){var t=this;this.Spine&&this.Spine.setCompleteListener(function(e,n){if(t.currentTrack==e)switch(e.animation?e.animation.name:""){case t.animSet.Attack:break;case t.animSet.Be_Attacked:t.setAnim(t.animSet.Move);break;case t.animSet.Death:if(t.type==r.EnemyTypes.CROW)return;if(t.type==r.EnemyTypes.OWL)return t.Spine.setAnimation(0,"Idle_Animation2",!0),t.direct=new cc.Vec3(-1,.3,0),void(t.isClaimReward=!0);t.node.active=!1,t.node.destroy();break;case t.animSet.Move:}})},e.prototype.setAnim=function(t,e){if(void 0===e&&(e=null),this.Spine){var n=!1;switch(t){case this.animSet.Attack:if(this.currentAnim==t)return;this.Spine.timeScale=1,n=!0;break;case this.animSet.Be_Attacked:this.Spine.timeScale=2;break;case this.animSet.Death:this.Spine.timeScale=1;break;case this.animSet.Move:if(this.Spine.timeScale=1,n=!0,this.currentAnim==t)return}this.previousAnim=this.currentAnim,this.currentTrack=this.Spine.setAnimation(0,t,n),this.currentAnim=t}},e.prototype.setAttack=function(){this.setAnim(this.animSet.Attack)},e.prototype.setState=function(t){switch(this.state=t,this.state){case this.State.IDLE:case this.State.HURT:case this.State.KILL:case this.State.WAIT:}},e.prototype.setPositionInit=function(){var t=0;switch(this.type){case r.EnemyTypes.SNAKE:t=s.default.Instance.Player.mRunningPos.y;break;case r.EnemyTypes.CROW:t=s.default.Instance.CanvasHeight;break;case r.EnemyTypes.SPIDER:t=s.default.Instance.CanvasHeight-this.node.height+50;break;case r.EnemyTypes.OWL:t=s.default.Instance.CanvasHeight/2+50}this.node.setPosition(this.node.x,t)},e.prototype.init=function(){switch(this.type){case r.EnemyTypes.SNAKE:this.enemyDefine=c.default.ENEMY_DEFINE_SNAKE,this.animSet.Attack="Attack_Animation",this.animSet.Be_Attacked="Be_Attacked_Animation",this.animSet.Death="Die_Animation",this.animSet.Move="Walk_Animation";break;case r.EnemyTypes.CROW:this.enemyDefine=c.default.ENEMY_DEFINE_CROW,this.animSet.Attack="Attack_Animation",this.animSet.Be_Attacked="Be_Attacked_Animation",this.animSet.Death="Die_Animation",this.animSet.Move="Flying_Animation";break;case r.EnemyTypes.OWL:this.enemyDefine=c.default.ENEMY_DEFINE_OWL,this.animSet.Attack="Idle_Animation",this.animSet.Be_Attacked="Idle_Animation",this.animSet.Death="Claim_Award_Animation",this.animSet.Move="Idle_Animation";break;case r.EnemyTypes.SPIDER:this.enemyDefine=c.default.ENEMY_DEFINE_SPIDER}var t=s.default.Instance.LevelMgr.waveCount;this.mHp=this.enemyDefine.baseHP+this.enemyDefine.addedHP*(t-1),this.initHP=this.mHp,this.score=this.enemyDefine.score,this.speed=this.enemyDefine.baseSpeed+this.enemyDefine.addedSpeed*(t-1),this.speed>this.enemyDefine.maxSpeed&&this.enemyDefine.maxSpeed>0&&(this.speed=this.enemyDefine.maxSpeed),this.speed*=c.default.SPEED_GAME_BASE,this.atkDefine=s.default.Instance.Player.IsUsingBooster?a.default.DEFAULT:a.default.BOOSTER,t=t>30?30:t,this.type!=r.EnemyTypes.OWL&&(this.atk=this.atkDefine[this.type][t]),this.mExp=this.enemyDefine.exp,this.initHP=this.mHp,this.isBoss&&(this.mExp=c.default.EXP_BOSS_ENEMY,this.node.setScale(c.default.ENEMY_DEFINE_BOSS.sizeMultiplier),this.mHp*=2,this.initHP=this.mHp,this.score=c.default.ENEMY_DEFINE_BOSS.score,this.glowBoss=cc.find("Glow_Boss",this.node),this.glowBoss.active=!0),this.UI_HP_BAR.active=!0,this.UI_HP_BAR_FILL.active=!0,this.updateHpUI(),this.setAnim(this.animSet.Attack)},e.prototype.setAction=function(){switch(this.type){case r.EnemyTypes.SNAKE:this.speed+=c.default.SPEED_PLAYER_NORMAL;break;case r.EnemyTypes.CROW:this.speed=1.3*c.default.SPEED_PLAYER_NORMAL;var t=this.node.position,e=this.Player.mRunningPos;this.direct=e.sub(t).normalize();break;case r.EnemyTypes.SPIDER:cc.tween(this.node).to(c.default.ENEMY_SPIDER_DROP_TIME,{y:this.Player.mRunningPos.y+this.Player.node.height-this.Player.node.height/3},{easing:"quadInOut"}).start()}this.setAnim(this.animSet.Move),this.isTouchDown=!1,this.updateHpUI()},e.prototype.spawnFx=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=0);var n=new cc.Vec2,i=this.node.getComponent(cc.BoxCollider).world.aabb,o=this.node.position;switch(this.type){case r.EnemyTypes.CROW:n.x=i.x,n.y=i.y;break;case r.EnemyTypes.SNAKE:n.x=i.x,n.y=i.y+i.height/2,o.y+=i.height/2,o.x-=i.width/2;break;case r.EnemyTypes.SPIDER:n.x=i.x,n.y=i.y+i.height/2}t?s.default.Instance.spawnXpEffect(o,e):s.default.Instance.spawnBloodFx(n)},e.prototype.reduceHp=function(){var t=this;this.setState(this.State.HURT),this.mHp-=this.Player.currentATK,this.spawnFx(),this.updateHpUI(),this.mHp<=0?(this.killed(),this.setAnim(this.animSet.Death),cc.audioEngine.play(s.default.Instance.enemySwipeAudio,!1,s.default.Instance.volume),cc.audioEngine.play(s.default.Instance.enemtDieAudio,!1,s.default.Instance.volume)):(this.setAnim(this.animSet.Be_Attacked),cc.audioEngine.play(s.default.Instance.enemySwipeAudio,!1,s.default.Instance.volume)),this.type==r.EnemyTypes.OWL&&(this.node.children[0].active=!1,this.node.children[0].active=!0,setTimeout(function(){t.node.children[0].active=!1},300)),null!=this.timeout&&clearTimeout(this.timeout),this.reduceSpeed(),this.timeout=setTimeout(function(){t.setNormalSpeed()},500)},e.prototype.reduceSpeed=function(){if(0==this.previousSpeed)switch(this.previousSpeed=this.speed,this.type){case r.EnemyTypes.SNAKE:this.speed/=1.3;break;case r.EnemyTypes.CROW:case r.EnemyTypes.SPIDER:this.speed/=1.5}},e.prototype.setNormalSpeed=function(){0!=this.previousSpeed&&(this.speed=this.previousSpeed,this.previousSpeed=0)},e.prototype.killed=function(){this.type==r.EnemyTypes.OWL?(Math.random()>.5?s.default.Instance.Player.increaATK():s.default.Instance.Player.increaHP(),console.log("fiasdoiajsd")):this.spawnFx(!0,this.mExp),this.die()},e.prototype.die=function(t){if(void 0===t&&(t=!1),this.UI_HP_BAR.active=!1,this.UI_HP_BAR_FILL.active=!1,this.node.getComponent(cc.BoxCollider).enabled=!1,this.glowBoss&&(this.glowBoss.active=!1),null!=this.timeout&&clearTimeout(this.timeout),s.default.Instance.LevelMgr.removeEnemy(this.node),this.isBoss&&s.default.Instance.Ground.spawnWater(),t)return this.node.active=!1,void this.node.destroy();this.Spine&&this.type==r.EnemyTypes.CROW&&(this.rigidboy.type=cc.RigidBodyType.Dynamic,this.direct.y=0)},e.prototype.IsCanSwipe=function(){return this.node.active&&this.state==this.State.IDLE},e.prototype.reset=function(){this.node.active?this.setState(this.State.IDLE):this.setState(this.State.WAIT)},e.prototype.updateHpUI=function(){this.mHp!=this.initHP&&(this.UI_HP_BAR.active=!0,this.UI_HP_BAR_FILL.active=!0);var t=(this.initHP-this.mHp)*this.UI_HP_BAR_FILL.width/this.initHP;this.UI_HP_BAR_FILL.children[0].setPosition(new cc.Vec3(-t,0,0)),this.type==r.EnemyTypes.OWL&&(this.UI_HP_BAR.active=!1,this.UI_HP_BAR_FILL.active=!1)},e.prototype.hardDestroy=function(){this.node.active=!1,this.node.destroy()},e.prototype.update=function(t){if(!s.default.Instance.IsPause()){switch(this.type){case r.EnemyTypes.CROW:if(!this.isActive&&this.node.x<=s.default.Instance.CanvasWidth+this.node.width&&(this.isActive=!0,this.setAction()),this.isActive){var e=this.direct.x*this.speed*t,n=this.direct.y*this.speed*t;this.node.setPosition(this.node.position.add(new cc.Vec3(e,n,0))),this.node.x<=this.Player.node.x&&this.node.y<=this.Player.node.y&&this.die(!0)}else this.node.setPosition(this.node.position.add(new cc.Vec3(-c.default.SPEED_PLAYER_NORMAL*t,0,0)));this.node.y<=-100&&(this.node.active=!1,this.node.destroy());break;case r.EnemyTypes.SNAKE:!this.isActive&&this.node.x<=s.default.Instance.CanvasWidth+2*this.node.width&&(this.isActive=!0,this.setAction()),this.isActive?this.node.setPosition(this.node.position.add(new cc.Vec3(-this.speed*t,0,0))):this.node.setPosition(this.node.position.add(new cc.Vec3(-c.default.SPEED_PLAYER_NORMAL*t,0,0)));break;case r.EnemyTypes.OWL:this.isClaimReward||(this.direct=new cc.Vec3(-1,0,0));var i=this.direct.x*c.default.SPEED_PLAYER_NORMAL*t,o=this.direct.y*this.speed*t;this.node.setPosition(this.node.position.add(new cc.Vec3(i,o,0)));break;case r.EnemyTypes.SPIDER:!this.isActive&&this.node.x<=s.default.Instance.CanvasWidth/2+this.node.width+200+s.default.Instance.CanvasWidth/4&&(this.isActive=!0,this.setAction()),this.isActive,this.node.setPosition(this.node.position.add(new cc.Vec3(-c.default.SPEED_PLAYER_NORMAL*t,0,0)))}this.node.x<s.default.Instance.CanvasWidth&&!this.isPlayedBossSound&&this.isBoss?(this.isPlayedBossSound=!0,s.default.Instance.playerRoarSound()):this.node.x<=-200&&this.die(!0)}},o([p({type:cc.Enum(r.EnemyTypes)})],e.prototype,"type",void 0),o([p(cc.Boolean)],e.prototype,"isBoss",void 0),o([p(cc.Node)],e.prototype,"UI_HP_BAR",void 0),o([p(cc.Node)],e.prototype,"UI_HP_BAR_FILL",void 0),o([p(cc.Node)],e.prototype,"glowBoss",void 0),o([p(sp.Skeleton)],e.prototype,"Spine",void 0),e=o([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"./EnemyDefine":"EnemyDefine","./EnemyMgr":"EnemyMgr","./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],EnviromentManager:[function(t,e,n){"use strict";cc._RF.push(e,"ec5a0++gIhFPIf0JeIq7eEr","EnviromentManager");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameDefine"),s=t("./GameMgr"),c=t("./Enviroment"),a=t("../utils/SingletonNode"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.envPrefabs=[],e.MixPrefabs=[],e.MixDecorPrefabs=[],e.changeEnvSpeed=1,e.MiddleSpeed=1,e.isChangingEnviroment=!1,e.isMoveDecor=!1,e.currentEnvIndex=0,e.nextEnvPrefab=null,e.currentEnv=null,e.currentMix=null,e.currentMixDecor=null,e.totalDistance=0,e.canvasWidth=0,e}return i(e,t),e.prototype.start=function(){this.currentEnvIndex=-1,this.changeEnvSpeed=r.default.SPEED_PLAYER_NORMAL/this.changeEnvSpeed,this.canvasWidth=1920,this.spawnNextEviroment(),this.spawnMixEnv(),this.InitPos(),setTimeout(function(){},5e3)},e.prototype.changeEnviroment=function(){this.totalDistance=0,this.isChangingEnviroment=!0,this.isMoveDecor=!0,this.spawnMixDecor()},e.prototype.update=function(t){if(!s.default.Instance.IsPause()){var e=this.node.children[2];if(e&&this.isMoveDecor&&(e.x-=this.changeEnvSpeed*t*1,e.x<-(this.canvasWidth-150)&&(this.isMoveDecor=!1,e.destroy())),this.isChangingEnviroment){var n=this.changeEnvSpeed*t*1;this.totalDistance+=n;for(var i=0,o=this.node.children;i<o.length;i++){var r=o[i];this.node.children.indexOf(r)>=2||(r.x-=n,r.x<-(this.canvasWidth-10)&&(r.x+=2*(this.canvasWidth-10),0==this.node.children.indexOf(r)&&(this.spawnNextEviroment(),this.SetMove(this.currentEnv))))}this.totalDistance>=2*this.canvasWidth&&(this.isChangingEnviroment=!1,this.spawnMixEnv())}}},e.prototype.spawnNextEviroment=function(){this.currentEnvIndex=this.currentEnvIndex>=this.envPrefabs.length-1?0:this.currentEnvIndex+1;var t=cc.instantiate(this.envPrefabs[this.currentEnvIndex]);cc.find("env",this.node).addChild(t),this.currentEnv&&this.currentEnv.destroy(),t.setPosition(new cc.Vec2),this.currentEnv=t},e.prototype.spawnMixEnv=function(){var t=cc.instantiate(this.MixPrefabs[this.currentEnvIndex]);cc.find("Mix",this.node).children[0].addChild(t),this.currentMix&&this.currentMix.destroy(),t.setPosition(new cc.Vec2),this.currentMix=t},e.prototype.spawnMixDecor=function(){var t=cc.instantiate(this.MixDecorPrefabs[this.currentEnvIndex]);this.node.addChild(t),this.currentMixDecor&&this.currentMixDecor.destroy(),t.setPosition(new cc.Vec2(this.canvasWidth-20,0)),this.currentMixDecor=t},e.prototype.InitPos=function(){for(var t=0;t<this.node.children.length;t++){this.node.children[t].setPosition(new cc.Vec2(t*this.node.children[t].width,0)),this.SetMove(this.currentEnv)}},e.prototype.SetMove=function(t){t.getComponent(c.default).SetMove()},o([p([cc.Prefab])],e.prototype,"envPrefabs",void 0),o([p([cc.Prefab])],e.prototype,"MixPrefabs",void 0),o([p([cc.Prefab])],e.prototype,"MixDecorPrefabs",void 0),o([p(Number)],e.prototype,"changeEnvSpeed",void 0),o([p(Number)],e.prototype,"MiddleSpeed",void 0),e=o([u],e)}(a.default());n.default=d,cc._RF.pop()},{"../utils/SingletonNode":"SingletonNode","./Enviroment":"Enviroment","./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],Enviroment:[function(t,e,n){"use strict";cc._RF.push(e,"862a5iSOoxCeJ2l1+x7ZADV","Enviroment");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./BGLoop"),s=cc._decorator,c=s.ccclass,a=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.canMove=!1,e}return i(e,t),e.prototype.SetMove=function(){this.canMove=!0;for(var t=0,e=this.node.children;t<e.length;t++){var n=e[t].getComponent(r.default);n&&(n.canMove=!0)}},e=o([c],e)}(cc.Component));n.default=a,cc._RF.pop()},{"./BGLoop":"BGLoop"}],GameDefine:[function(t,e,n){"use strict";cc._RF.push(e,"66d36XhLrxH8IPu3QV/3hpp","GameDefine"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=new(function(){return function(){this.isCheating=!1,this.WAVE_DISTANCE_2_WAVE=100,this.SHOW_GAME_DEBUG=!0,this.GAME_WIDTH=576,this.GAME_HEIGHT=1024,this.VOLUME_VOICE_INPUT_AMPLIFIER=5,this.SPEED_GAME_BASE=60,this.SPEED_GRAVITY=-40,this.SPEED_PLAYER_NORMAL=3.5,this.SPEED_PLAYER_JUMP=11.5,this.TIME_API_TIMEOUT=1e4,this.TIME_GAME_PLAY=60,this.RATIO_HIGH_DEVICE_MIN=2,this.PLAYER_MAX_LV=15,this.PLAYER_BASE_HP=10,this.PLAYER_BASE_ATK=10,this.PLAYER_ADD_HP_LV_UP=0,this.PLAYER_ADD_ATK_LV_UP=10,this.FREEZE=5,this.SLOW=5,this.RAGE=5,this.INVISIBLE=5,this.LV_UP_PARAM=[{requireExp:0,hp:10,atk:10,reqSession:0},{requireExp:1e3,hp:10,atk:11,reqSession:18},{requireExp:2e3,hp:10,atk:12,reqSession:36},{requireExp:4e3,hp:10,atk:13,reqSession:73},{requireExp:7e3,hp:10,atk:14,reqSession:127},{requireExp:12e3,hp:10,atk:15,reqSession:218},{requireExp:2e4,hp:10,atk:16,reqSession:364},{requireExp:33e3,hp:10,atk:17,reqSession:600},{requireExp:54e3,hp:10,atk:18,reqSession:982},{requireExp:88e3,hp:10,atk:19,reqSession:1600},{requireExp:143e3,hp:10,atk:20,reqSession:2600},{requireExp:232e3,hp:10,atk:21,reqSession:4218},{requireExp:376e3,hp:10,atk:22,reqSession:6836},{requireExp:609e3,hp:10,atk:23,reqSession:11073},{requireExp:986e3,hp:10,atk:24,reqSession:17927},{requireExp:1596e3,hp:10,atk:25,reqSession:29018}],this.WATER_BASE_LENGTH=1,this.WATER_ADDED_LENGTH=1,this.WATER_MAX_LENGTH=15,this.PLAYER_FLY_UP_SPEED=50,this.PLAYER_DROP_DOWN_SPEED=70,this.PLAYER_MAX_JUMP_HEIGHT=80,this.HP_BOOST=10,this.ATK_BOOST=10,this.EXP_NORMAL_ENEMY=1,this.EXP_BOSS_ENEMY=2,this.EXP_LANTERN=5,this.WAVE_BASE_ENEMIES=8,this.WAVE_ADDED_ENEMIES=1,this.WAVE_MAX_ENEMIES=18,this.WAVE_BASE_SPAWN_SPEED=2,this.WAVE_REDUCE_SPAWN_SPEED=.1,this.WAVE_MIN_SPAWN_SPEED=1,this.ENEMY_DEFINE_SPIDER={baseHP:50,addedHP:60,baseSpeed:5,addedSpeed:0,maxSpeed:0,score:10,exp:1},this.ENEMY_DEFINE_SNAKE={baseHP:40,addedHP:60,baseSpeed:2,addedSpeed:.2,maxSpeed:5,score:5,exp:1},this.ENEMY_DEFINE_CROW={baseHP:50,addedHP:60,baseSpeed:15,addedSpeed:1,maxSpeed:25,score:15,exp:1},this.ENEMY_DEFINE_OWL={baseHP:20,addedHP:0,baseSpeed:20,addedSpeed:0,maxSpeed:25,score:15,exp:5},this.ENEMY_DEFINE_BOSS={hPMultiplier:150,sizeMultiplier:2,score:100,addedHP:50},this.ENEMY_SPIDER_DROP_TIME=1,this.ENEMY_CROW_DROP_TIME=3,this.OFFSET_TIME_AFTER_KILL_BOSS=1,this.GRAVITY_DOWN=1.5,this.GRAVITY_UP=1,this.POWER_UP_SPEED=3,this.SHOW_GAME_DEBUG&&console.warn("Playing in debug mode."),this.SPEED_GRAVITY*=this.SPEED_GAME_BASE,this.SPEED_PLAYER_NORMAL*=this.SPEED_GAME_BASE,this.SPEED_PLAYER_JUMP*=this.SPEED_GAME_BASE,this.POWER_UP_SPEED*=this.SPEED_GAME_BASE,this.PLAYER_ADD_ATK_LV_UP/=100,this.isCheating&&(this.PLAYER_BASE_HP=1e5,this.GRAVITY_DOWN=0)}}()),cc._RF.pop()},{}],GameMgr:[function(t,e,n){"use strict";cc._RF.push(e,"40dd4RMmi1N/YOCvFrL5ZaW","GameMgr");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../utils/SingletonNode"),s=t("../utils/Timer"),c=t("./Enemy"),a=t("./LevelMgr"),h=t("./Player"),u=t("./Ground"),p=t("./UIManager"),d=t("./ScreenManager"),l=t("./Effect"),f=t("../utils/Helper"),y=cc._decorator,_=y.ccclass,v=y.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Canvas=null,e.Camera=null,e.Player=null,e.LevelMgr=null,e.Ground=null,e.bgm=null,e.enemySwipeAudio=null,e.enemtDieAudio=null,e.playerBeAttacked=null,e.bossAppear=null,e.fxBlood=null,e.xpEffect=null,e.fxContainer=null,e.xpUI=null,e.MuteSprite=null,e.Mute=null,e.UnMute=null,e.points=[],e.isBlockTarget=!1,e.score=0,e.touchCount=0,e.scoreTimer=null,e.isPause=!1,e.volume=1,e.STATE={TUTORIAL:0,INGAME:1,GAMEOVER:2},e.state=0,e}return i(e,t),Object.defineProperty(e.prototype,"CanvasHeight",{get:function(){return this.screenSize.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"CanvasWidth",{get:function(){return this.screenSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ScreenRatio",{get:function(){return Math.max(this.Canvas.width,this.Canvas.height)/Math.min(this.Canvas.width,this.Canvas.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsHighRatioDevice",{get:function(){return this.ScreenRatio>=2},enumerable:!1,configurable:!0}),e.prototype.playerRoarSound=function(){cc.audioEngine.play(this.bossAppear,!1,this.volume)},e.prototype.spawnBloodFx=function(t){var e=cc.instantiate(this.fxBlood);this.fxContainer.addChild(e),e.setPosition(t),setTimeout(function(){e.destroy()},500)},e.prototype.spawnXpEffect=function(t,e){void 0===e&&(e=1);for(var n=0;n<e;n++){var i=t;1!=e&&(i.y+=f.default.RandInt(0,100));var o=cc.instantiate(this.xpEffect);this.fxContainer.addChild(o),o.setPosition(i),o.getComponent(l.default).action(this.xpUI,this.CanvasWidth,this.CanvasHeight)}},e.prototype.setMute=function(){1==this.volume?(this.volume=0,this.MuteSprite.spriteFrame=this.Mute,cc.audioEngine.pauseAll()):(this.MuteSprite.spriteFrame=this.UnMute,this.volume=1,cc.audioEngine.resumeAll())},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.screenSize=cc.view.getVisibleSize(),console.log(this.screenSize),this.Canvas=cc.find("Canvas"),this.effectNode=new cc.Node,this.node.addChild(this.effectNode),this.ctx=this.effectNode.addComponent(cc.Graphics),this.ctx.lineJoin=cc.Graphics.LineJoin.BEVEL,cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-720),this.scoreTimer=new s.default,this.scoreTimer.SetDuration(1),console.log("Ver 11")},e.prototype.addScore=function(t){void 0===t&&(t=0),this.score+=t,p.default.Instance.updateScore(this.score)},e.prototype.setState=function(t){switch(this.state=t,this.state){case this.STATE.TUTORIAL:setTimeout(function(){d.default.Instance.ShowHowToPlay()},2e3),this.onPauseGame();break;case this.STATE.INGAME:this.onResumeGame();break;case this.STATE.GAMEOVER:this.onPauseGame(),this.showEndGame()}},e.prototype.start=function(){cc.director.getCollisionManager().enabled=!0,cc.director.getCollisionManager().enabledDrawBoundingBox=!0,this.node.on("touchstart",this.onTouchStart,this),this.node.on("touchmove",this.onTouchMove,this),this.node.on("touchend",this.onTouchEnd,this),this.node.on("touchcancel",this.onTouchEnd,this),this.addScore(),this.onPauseGame()},e.prototype.EnterGame=function(){this.onResumeGame(),this.setState(this.STATE.TUTORIAL)},e.prototype.StartGame=function(){cc.audioEngine.playMusic(this.bgm,!0),this.Player.play(),this.setState(this.STATE.INGAME)},e.prototype.IsPause=function(){return this.isPause},e.prototype.onPauseGame=function(){this.isPause=!0,cc.audioEngine.pauseMusic()},e.prototype.onResumeGame=function(){this.isPause=!1,cc.audioEngine.resumeMusic()},e.prototype.onGameReplay=function(){d.default.Instance.resetAll(),this.score=0,this.addScore(),this.Player.node.active=!0,this.LevelMgr.replay(),this.Player.replay(),this.setState(this.STATE.INGAME),this.onResumeGame()},e.prototype.onRevival=function(){d.default.Instance.resetAll(),this.Player.node.active=!0,this.LevelMgr.revival(),this.Player.replay(),this.setState(this.STATE.INGAME),this.onResumeGame()},e.prototype.showEndGame=function(){d.default.Instance.ShowOops()},e.prototype.endGame=function(){this.setState(this.STATE.GAMEOVER)},e.prototype.update=function(t){if(!this.isPause)switch(this.state){case this.STATE.TUTORIAL:case this.STATE.INGAME:this.scoreTimer.Update(t),this.scoreTimer.IsDone()&&(this.scoreTimer.Reset(),this.addScore(1)),this.updateDraw(t);break;case this.STATE.GAMEOVER:}},e.prototype.onDeviceMotionEvent=function(t){var e=t.acc.x,n=t.acc.y;e=Math.round(100*e)/100,n=Math.round(100*n)/100},e.prototype.onTouchEnd=function(t,e){this.touchCount--,this.touchCount<0&&(this.touchCount=0),this.resetEnemies(),this.points=[],this.points.length=0},e.prototype.onTouchStart=function(t,e){this.touchCount++,this.resetEnemies()},e.prototype.onTouchMove=function(t,e){if(1==this.touchCount){var n=t.getLocation(),i=t.getPreviousLocation(),o=n.sub(i).mag();if(o>1)for(var r=Math.ceil(o),s=0;s<r;s++){var a=n.x-i.x,h=n.y-i.y,u=s/o,p=cc.v2(i.x+a*u,i.y+h*u);this.points.length>400&&this.points.shift(),this.points.push(p)}if(!this.isPause){var d=this.LevelMgr.enemyArr;for(s=d.length-1;s>=0;s--){var l=d[s].getComponent(c.default),f=l.getComponent(cc.BoxCollider).world.aabb;f.contains(n)&&l.IsCanSwipe()?(this.isBlockTarget=!0,l.reduceHp()):f.contains(n)||l.reset()}}}},e.prototype.resetEnemies=function(){var t=this.LevelMgr.enemyArr;this.isBlockTarget=!1;for(var e=t.length-1;e>=0;e--)t[e].getComponent(c.default).reset()},e.prototype.updateDraw=function(t){if(this.points.length<30)for(var e=0;e<1&&this.points.length>0;e++)this.points.shift();else{for(e=0;e<9&&this.points.length>0;e++)this.points.shift();for(;this.points.length>400;)this.points.shift()}this.ctx.clear();var n=[this.randomNum(0,255),this.randomNum(0,200),this.randomNum(150,255)];this.ctx.strokeColor=new cc.Color(n[0],n[1],n[2]),this.drawKnife()},e.prototype.randomNum=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},e.prototype.drawKnife=function(){for(var t=40,e=1,n=1,i=this.points.length,o=i-2;o>=0;o--){++n<70?(t=e,e+=1):t-=2*t/i;var r=this.node.convertToNodeSpaceAR(this.points[o+1]),s=this.node.convertToNodeSpaceAR(this.points[o]);this.ctx.moveTo(r.x,r.y),this.ctx.lineTo(s.x,s.y),this.ctx.lineWidth=t,this.ctx.stroke()}},o([v(cc.Camera)],e.prototype,"Camera",void 0),o([v(h.default)],e.prototype,"Player",void 0),o([v(a.default)],e.prototype,"LevelMgr",void 0),o([v(u.default)],e.prototype,"Ground",void 0),o([v(cc.AudioClip)],e.prototype,"bgm",void 0),o([v(cc.AudioClip)],e.prototype,"enemySwipeAudio",void 0),o([v(cc.AudioClip)],e.prototype,"enemtDieAudio",void 0),o([v(cc.AudioClip)],e.prototype,"playerBeAttacked",void 0),o([v(cc.AudioClip)],e.prototype,"bossAppear",void 0),o([v(cc.Prefab)],e.prototype,"fxBlood",void 0),o([v(cc.Prefab)],e.prototype,"xpEffect",void 0),o([v(cc.Node)],e.prototype,"fxContainer",void 0),o([v(cc.Node)],e.prototype,"xpUI",void 0),o([v(cc.Sprite)],e.prototype,"MuteSprite",void 0),o([v(cc.SpriteFrame)],e.prototype,"Mute",void 0),o([v(cc.SpriteFrame)],e.prototype,"UnMute",void 0),e=o([_],e)}(r.default());n.default=m,cc._RF.pop()},{"../utils/Helper":"Helper","../utils/SingletonNode":"SingletonNode","../utils/Timer":"Timer","./Effect":"Effect","./Enemy":"Enemy","./Ground":"Ground","./LevelMgr":"LevelMgr","./Player":"Player","./ScreenManager":"ScreenManager","./UIManager":"UIManager"}],GameObject:[function(t,e,n){"use strict";cc._RF.push(e,"ac648lWW65FVL6lqaVqOgIb","GameObject");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.load=function(){},e.prototype.kill=function(){this.node.active=!1},e=o([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],Ground:[function(t,e,n){"use strict";cc._RF.push(e,"79b08W0VJ9NR4jj8euOTeio","Ground");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameMgr"),s=t("./GameDefine"),c=t("./ScreenManager"),a=t("./Decoration"),h=t("./EnviromentManager"),u=cc._decorator,p=u.ccclass,d=u.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.groundPrefabs=null,e.waterPrefabs=null,e.groundEndPrefab=null,e.groundBeignPrefab=null,e.groundFullFrame=[],e.groundEndFrame=[],e.groundBeginFrame=[],e.platforms=[],e.platformWidth=0,e.currentWidth=0,e.speed=0,e.isSpeedDown=!1,e.waterPlatform=[],e.groundBegin=[],e.groundEnd=[],e.canSpawnEnemy=!1,e.currentMode=0,e}return i(e,t),e.prototype.start=function(){this.init()},e.prototype.spawnGround=function(t,e){for(void 0===e&&(e=0),this.platformWidth=this.groundPrefabs.data.width;this.getPositionToSpawnEnemy()<t;){var n=cc.instantiate(this.groundPrefabs);n.getComponent(cc.Sprite).spriteFrame=this.groundFullFrame[this.currentMode],this.node.children[1].addChild(n);var i=this.platforms.length>0?this.platforms[this.platforms.length-1].x+this.platforms[this.platforms.length-1].width:0;n.setPosition(i,0),this.currentWidth+=this.platformWidth,this.platforms.push(n),a.default.Instance.spawnNewDecor(i)}},e.prototype.getPositionToSpawnEnemy=function(){var t=0;return this.platforms.length>0&&(t=this.platforms[this.platforms.length-1].x+this.platforms[this.platforms.length-1].width),t},e.prototype.stopSpawnEnemy=function(){this.canSpawnEnemy=!1},e.prototype.isCanSpawnEnemy=function(){return this.canSpawnEnemy},e.prototype.getWaterToFly=function(){return 0==this.groundEnd.length?null:this.groundEnd[0].x},e.prototype.getWaterToDrop=function(){return 1!=this.groundBegin.length?null:this.groundBegin[0].x+this.groundBegin[0].width},e.prototype.spawnWater=function(){var t=s.default.WATER_BASE_LENGTH+s.default.WATER_ADDED_LENGTH*(r.default.Instance.LevelMgr.waveCount-1);t=t>s.default.WATER_MAX_LENGTH?s.default.WATER_MAX_LENGTH:t;var e=cc.instantiate(this.groundEndPrefab);e.getComponent(cc.Sprite).spriteFrame=this.groundEndFrame[this.currentMode],this.node.children[1].addChild(e),e.setPosition(this.platforms[this.platforms.length-1].x+this.platforms[this.platforms.length-1].width,0),this.currentWidth+=e.width,this.platforms.push(e);var n=!0;this.groundEnd.push(e);for(var i=0;i<t;i++){var o=cc.instantiate(this.waterPrefabs);this.node.children[0].addChild(o);var u=this.platforms[this.platforms.length-1].x+this.platforms[this.platforms.length-1].width;this.currentWidth+=o.width,this.platformWidth,n&&(n=!1,u-=30,this.currentWidth-=30,30),o.setPosition(u,0),this.platforms.push(o),this.waterPlatform.push(o)}var p=cc.instantiate(this.groundBeignPrefab);p.getComponent(cc.Sprite).spriteFrame=this.groundBeginFrame[this.currentMode],this.node.children[1].addChild(p),p.setPosition(this.platforms[this.platforms.length-1].x+this.platforms[this.platforms.length-1].width-30,0),this.currentWidth+=p.width,this.platforms.push(p),this.groundBegin.push(p),a.default.Instance.changeBackground(p.x),this.canSpawnEnemy=!0,r.default.Instance.LevelMgr.spawnPowerUp().setPosition(new cc.Vec3(this.getMiddleWater(),100,0));var d=(this.groundEnd[0].x-r.default.Instance.Player.node.x-r.default.Instance.CanvasWidth/5)/s.default.SPEED_PLAYER_NORMAL;c.default.Instance.ShowWaterComming(d),setTimeout(function(){h.default.Instance.changeEnviroment()},1e3),this.currentMode=this.currentMode>=this.groundFullFrame.length-1?0:this.currentMode+1},e.prototype.getMiddleWater=function(){return(this.groundEnd[this.groundEnd.length-1].x+this.groundEnd[this.groundEnd.length-1].width+this.groundBegin[this.groundBegin.length-1].x)/2},e.prototype.update=function(t){r.default.Instance.IsPause()||(this.updatePlatform(t),this.spawnNewGround(t))},e.prototype.spawnNewGround=function(t){if(0!=this.platforms.length){var e=this.platforms[this.platforms.length-1];if(e.x+e.width<r.default.Instance.CanvasWidth+20){var n=cc.instantiate(this.groundPrefabs);n.getComponent(cc.Sprite).spriteFrame=this.groundFullFrame[this.currentMode],this.node.children[1].addChild(n);var i=this.platforms[this.platforms.length-1].x+this.platforms[this.platforms.length-1].width;n.setPosition(i,0),this.currentWidth+=this.platformWidth,this.platforms.push(n),a.default.Instance.spawnNewDecor(i)}}},e.prototype.updatePlatform=function(t){for(var e=0,n=this.platforms;e<n.length;e++){var i=n[e];i.setPosition(i.position.add(new cc.Vec3(-s.default.SPEED_PLAYER_NORMAL*t,0,0)))}this.platforms.length>0&&this.platforms[0].x<-this.platforms[0].width-30&&(-1!=this.waterPlatform.indexOf(this.platforms[0])&&this.waterPlatform.shift(),-1!=this.groundBegin.indexOf(this.platforms[0])&&this.groundBegin.shift(),-1!=this.groundEnd.indexOf(this.platforms[0])&&this.groundEnd.shift(),this.platforms[0].active=!1,this.platforms[0].destroy(),this.platforms.shift(),this.currentWidth-=this.platformWidth)},e.prototype.destroyAll=function(){for(var t=0,e=this.platforms;t<e.length;t++){e[t].destroy()}this.platforms=[],this.groundBegin=[],this.groundEnd=[],this.waterPlatform=[]},e.prototype.init=function(){this.speed=s.default.SPEED_PLAYER_NORMAL},e.prototype.slowDown=function(){},e.prototype.speedUp=function(){},o([d(cc.Prefab)],e.prototype,"groundPrefabs",void 0),o([d(cc.Prefab)],e.prototype,"waterPrefabs",void 0),o([d(cc.Prefab)],e.prototype,"groundEndPrefab",void 0),o([d(cc.Prefab)],e.prototype,"groundBeignPrefab",void 0),o([d([cc.SpriteFrame])],e.prototype,"groundFullFrame",void 0),o([d([cc.SpriteFrame])],e.prototype,"groundEndFrame",void 0),o([d([cc.SpriteFrame])],e.prototype,"groundBeginFrame",void 0),e=o([p],e)}(cc.Component);n.default=l,cc._RF.pop()},{"./Decoration":"Decoration","./EnviromentManager":"EnviromentManager","./GameDefine":"GameDefine","./GameMgr":"GameMgr","./ScreenManager":"ScreenManager"}],Helper:[function(t,e,n){"use strict";cc._RF.push(e,"90a75udUmlJUqYerDKv5BZf","Helper"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=new(function(){function t(){}return t.prototype.Rand=function(t,e){return Math.random()*(e-t)+t},t.prototype.RandInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},t.prototype.RandArgument=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return arguments[this.RandInt(0,arguments.length-1)]},t.prototype.RandArray=function(t){return t[this.RandInt(0,t.length-1)]},t.prototype.RandTypeEnum=function(t){var e=Object.keys(t);return this.RandInt(0,e.length/2-1)},t.prototype.GetKey=function(t,e){return Object.keys(t)[e]},t.prototype.GetKeyEnum=function(t,e){var n=Object.keys(t);return n[e+n.length/2]},t.prototype.GetIndexEnum=function(t,e){for(var n=Object.keys(t),i=n.length/2;i<n.length;i++)if(n[i]==e)return i-n.length/2;return-1},t.prototype.Normalized=function(t,e,n,i){var o=t-n,r=e-i,s=Math.sqrt(o*o+r*r);return new cc.Vec2(o/s,r/s)},t.prototype.MoveToTarget=function(t,e,n){return n=Math.abs(n),t<e?Math.min(e,t+n):Math.max(e,t-n)},t.prototype.Collision2Rect=function(t,e){return!(t.x+t.width<e.x||t.y+t.height<e.y||e.x+e.width<t.x||e.y+e.height<t.y)},t.prototype.CollisionPointRect=function(t,e,n){return!(t<n.x||e<n.y||t>n.x+n.width||e>n.y+n.height)},t.prototype.Distance=function(t,e,n,i){return Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))},t.prototype.Constrain=function(t,e,n){return t=Math.max(e,t),t=Math.min(n,t)},t.prototype.ToRadian=function(t){return t/180*Math.PI},t.prototype.ToAngle=function(t){return t/Math.PI*180},t.prototype.TimeoutPromise=function(t,e){var n=new Promise(function(e,n){setTimeout(function(){n("Timed out.")},t)});return Promise.race([e,n])},t.prototype.HttpRequest=function(t,e,n,i,o,r){void 0===o&&(o=null),void 0===r&&(r={});var s=window.logEvent||console.log,c=Date.now(),a=e.split("/").pop().split("?").shift();return new Promise(function(h,u){var p=new XMLHttpRequest;p.open(t,e,!0),"POST"==t&&p.setRequestHeader("Content-Type","application/json");for(var d=0,l=o;d<l.length;d++){var f=l[d];p.setRequestHeader(f.key,f.value)}i&&(p.responseType=i),p.timeout=1e4,p.onreadystatechange=function(){4==p.readyState&&(200==p.status?h(p.response):u(p.response),s(a,{method:t,url:e,body:n,requestParams:r,reponseStatus:p.status,response:p.response,duration:Date.now()-c}))},p.onerror=function(i){s("apiRequestError",{apiName:a,method:t,url:e,body:n,requestParams:r,duration:Date.now()-c}),u("error")},p.ontimeout=function(t){u("timed out")},p.send(n)})},t.prototype.DrawLine=function(t,e,n,i,o,r,s){void 0===r&&(r=cc.Color.RED),void 0===s&&(s=2),t.lineWidth=s,t.strokeColor=r,t.moveTo(e,n),t.lineTo(i,o),t.stroke()},t.prototype.DrawSquare=function(t,e,n,i,o,r){void 0===o&&(o=cc.Color.RED),void 0===r&&(r=2),this.DrawRect(t,e,n,i,i,o,r)},t.prototype.DrawRect=function(t,e,n,i,o,r,s){void 0===r&&(r=cc.Color.RED),void 0===s&&(s=2),t.lineWidth=s,t.strokeColor=r,"number"==typeof e?t.rect(e,n,i,o):t.rect(e.x,e.y,e.width,e.height),t.stroke()},t.prototype.DrawArc=function(t,e,n,i,o,r,s,c,a,h,u){void 0===o&&(o=0),void 0===r&&(r=2*Math.PI),void 0===s&&(s=0),void 0===c&&(c=!0),void 0===a&&(a=cc.Color.RED),void 0===h&&(h=2),void 0===u&&(u=!1);var p=2*Math.PI,d=1.5*Math.PI;r=p-(r+=d+s),o=(o=p-(o+=d+s))>p?o%p:o,r=r>p?r%p:r,t.lineWidth=h,t.strokeColor=a,t.arc(e,n,i,o,r,c),u&&(t.lineTo(e,n),t.close()),t.stroke()},t.prototype.DrawCircle=function(t,e,n,i,o,r){void 0===o&&(o=cc.Color.RED),void 0===r&&(r=2),this.DrawEllipse(t,e,n,i,i,o,r)},t.prototype.DrawEllipse=function(t,e,n,i,o,r,s){void 0===r&&(r=cc.Color.RED),void 0===s&&(s=2),t.lineWidth=s,t.strokeColor=r,t.ellipse(e,n,i,o),t.stroke()},t.prototype.FillSquare=function(t,e,n,i,o){void 0===o&&(o=cc.Color.RED),this.FillRect(t,e,n,i,i,o)},t.prototype.FillRect=function(t,e,n,i,o,r){void 0===r&&(r=cc.Color.RED),t.fillColor=r,this.DrawRect(t,e,n,i,o,r,0),t.fill()},t.prototype.FillArc=function(t,e,n,i,o,r,s,c,a){void 0===o&&(o=0),void 0===r&&(r=2*Math.PI),void 0===s&&(s=0),void 0===c&&(c=!0),void 0===a&&(a=cc.Color.RED),t.fillColor=a,this.DrawArc(t,e,n,i,o,r,s,c,void 0,0,!0),t.fill()},t.prototype.FillCircle=function(t,e,n,i,o){void 0===o&&(o=cc.Color.RED),this.FillEllipse(t,e,n,i,i,o)},t.prototype.FillEllipse=function(t,e,n,i,o,r){void 0===r&&(r=cc.Color.RED),t.fillColor=r,this.DrawEllipse(t,e,n,i,o,r,0),t.fill()},t}()),cc._RF.pop()},{}],Item:[function(t,e,n){"use strict";cc._RF.push(e,"961f25TL7VG+qduOlBu3ykl","Item");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.ItemType=void 0;var r,s=t("./GameDefine"),c=t("./GameMgr"),a=cc._decorator,h=a.ccclass,u=a.property;(function(t){t[t.HP=0]="HP",t[t.POWER_UP=1]="POWER_UP"})(r=n.ItemType||(n.ItemType={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=r.POWER_UP,e.isPowerUp=!1,e.isMoveUp=!1,e}return i(e,t),e.prototype.start=function(){},e.prototype.useItem=function(){var t=this;switch(this.type){case r.HP:c.default.Instance.Player.increaHP(10),this.getComponent(cc.BoxCollider).enabled=!1,cc.tween(this.node).by(.5,{scale:1.2},{easing:"bounceOut"}).delay(.2).call(function(){t.node.active=!1,t.node.destroy()}).start();break;case r.POWER_UP:c.default.Instance.Player.increaATK(10),this.getComponent(cc.BoxCollider).enabled=!1,cc.tween(this.node).by(.5,{scale:1.2},{easing:"bounceOut"}).delay(.2).call(function(){t.node.active=!1,t.node.destroy()}).start()}},e.prototype.hardDestroy=function(){this.node.active=!1,this.node.destroy()},e.prototype.setPowerUp=function(){this.isPowerUp=!0},e.prototype.update=function(t){if(!c.default.Instance.IsPause()){if(this.isPowerUp&&this.isMoveUp){this.node.setPosition(this.node.position.add(new cc.Vec3(0,s.default.POWER_UP_SPEED*t,0)));var e=c.default.Instance.CanvasHeight*(s.default.PLAYER_MAX_JUMP_HEIGHT-30)/100;this.node.y>e&&(this.node.y=e)}this.isPowerUp&&!this.isMoveUp&&this.node.x<c.default.Instance.CanvasWidth-200&&(this.isMoveUp=!0),this.node.setPosition(this.node.position.add(new cc.Vec3(-s.default.SPEED_PLAYER_NORMAL*t,0,0))),this.node.x<-50-this.node.width&&(this.node.active=!1,this.node.destroy())}},o([u({type:cc.Enum(r)})],e.prototype,"type",void 0),o([u(cc.Boolean)],e.prototype,"isPowerUp",void 0),e=o([h],e)}(cc.Component);n.default=p,cc._RF.pop()},{"./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],LevelMgr:[function(t,e,n){"use strict";cc._RF.push(e,"42a23NwLVBIILOlnsx4m4AY","LevelMgr");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./Enemy"),s=t("./GameMgr"),c=t("./UIManager"),a=t("./Item"),h=cc._decorator,u=h.ccclass,p=h.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.TutorialWave=[],e.EasyWave=[],e.HardWave=[],e.DifficultWave=[],e.EnemyPrefabs=[],e.ItemPrefabs=[],e.EnemyMgr=null,e.ItemMgr=null,e.isTutorial=!1,e.isSpawnFirst=!1,e.currentWaveArr=[],e.currentWavePrefab=null,e.currentWave=null,e.LastObject=null,e.currentWaveIndex=0,e.waveCount=0,e.enemyArr=[],e.STATE={TUTORIAL:0,RUNNING_WAVE:1,FINISH_WAVE:2,RUNNING_WATER:3,FINISH_WATER:4},e}return i(e,t),e.prototype.setState=function(t){switch(this.mState=t,this.mState){case this.STATE.TUTORIAL:case this.STATE.RUNNING_WAVE:case this.STATE.FINISH_WAVE:break;case this.STATE.RUNNING_WATER:case this.STATE.FINISH_WATER:}},e.prototype.start=function(){var t=this;this.currentWaveIndex=0,this.currentWaveArr=this.isTutorial?this.TutorialWave:this.EasyWave,this.setState(this.STATE.RUNNING_WAVE),this.spawnWaveViaPrefab(),setTimeout(function(){s.default.Instance.Ground.spawnGround(t.getLastEnemy().x)},100)},e.prototype.update=function(t){if(!s.default.Instance.IsPause()){switch(this.mState){case this.STATE.TUTORIAL:case this.STATE.RUNNING_WAVE:case this.STATE.FINISH_WAVE:case this.STATE.RUNNING_WATER:case this.STATE.FINISH_WATER:}var e=s.default.Instance.Ground.getWaterToDrop();e&&s.default.Instance.Ground.isCanSpawnEnemy()&&e<s.default.Instance.CanvasWidth+20&&(this.spawnWaveViaPrefab(s.default.Instance.Ground.getPositionToSpawnEnemy()),s.default.Instance.Ground.spawnGround(this.getLastEnemy().x),s.default.Instance.Ground.stopSpawnEnemy())}},e.prototype.getLastEnemy=function(){if(0==this.enemyArr.length)return null;for(var t=this.enemyArr[0],e=0;e<this.enemyArr.length;e++)0!=e&&this.enemyArr[e].position.x>this.enemyArr[e-1].position.x&&(t=this.enemyArr[e]);return t},e.prototype.spawnPowerUp=function(){var t=cc.instantiate(this.ItemPrefabs[Math.random()<.5?0:1]);return this.ItemMgr.addChild(t),t},e.prototype.changeWave=function(){if(this.currentWaveArr==this.EasyWave)this.currentWaveIndex=0,this.currentWaveArr=this.HardWave;else if(this.currentWaveArr==this.HardWave)this.currentWaveIndex=0,this.currentWaveArr=this.DifficultWave;else if(this.currentWaveArr==this.DifficultWave)return},e.prototype.destroyAll=function(){for(var t=0,e=this.EnemyMgr.children;t<e.length;t++){(o=e[t])&&o.getComponent(r.default).hardDestroy()}for(var n=0,i=this.ItemMgr.children;n<i.length;n++){var o;(o=i[n])&&o.getComponent(a.default).hardDestroy()}this.enemyArr=[],s.default.Instance.Ground.destroyAll()},e.prototype.replay=function(){this.currentWaveIndex=0,this.waveCount=1,this.destroyAll(),this.spawnWaveViaPrefab(0,!0),s.default.Instance.Ground.spawnGround(this.getLastEnemy().x)},e.prototype.revival=function(){this.destroyAll(),this.spawnWaveViaPrefab(),s.default.Instance.Ground.spawnGround(this.getLastEnemy().x)},e.prototype.removeEnemy=function(t){var e=this.enemyArr.indexOf(t);e>-1&&this.enemyArr.splice(e,1)},e.prototype.spawnWaveViaPrefab=function(t,e){void 0===t&&(t=0),void 0===e&&(e=!1),e||(this.waveCount++,this.currentWaveIndex=this.currentWaveIndex>=this.currentWaveArr.length-1?0:this.currentWaveIndex+1),this.currentWavePrefab=this.currentWaveArr[this.currentWaveIndex];for(var n=0,i=this.currentWavePrefab.data.children;n<i.length;n++){var o=i[n];if(null!=o.getComponent(r.default)){var a=o.position,h=cc.instantiate(this.EnemyPrefabs[o.getComponent(r.default).type]);h.getComponent(r.default).isBoss=o.getComponent(r.default).isBoss,this.EnemyMgr.addChild(h);var u=0==t?s.default.Instance.CanvasWidth:s.default.Instance.CanvasWidth/2;h.setPosition(a.x+u+t,0),this.enemyArr.push(h)}}this.LastObject=this.getLastEnemy(),c.default.Instance.updateWave(this.waveCount)},o([p([cc.Prefab])],e.prototype,"TutorialWave",void 0),o([p([cc.Prefab])],e.prototype,"EasyWave",void 0),o([p([cc.Prefab])],e.prototype,"HardWave",void 0),o([p([cc.Prefab])],e.prototype,"DifficultWave",void 0),o([p([cc.Prefab])],e.prototype,"EnemyPrefabs",void 0),o([p([cc.Prefab])],e.prototype,"ItemPrefabs",void 0),o([p(cc.Node)],e.prototype,"EnemyMgr",void 0),o([p(cc.Node)],e.prototype,"ItemMgr",void 0),e=o([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"./Enemy":"Enemy","./GameMgr":"GameMgr","./Item":"Item","./UIManager":"UIManager"}],MiddleGround:[function(t,e,n){"use strict";cc._RF.push(e,"93bb3i+031GTb9K+nIgrS3b","MiddleGround");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameDefine"),s=t("./GameMgr"),c=t("../utils/SingletonNode"),a=cc._decorator,h=a.ccclass,u=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.speed=1,e.Desert_Decor=[],e.City_Decor=[],e.Mix_Decor=null,e.canvasWidth=0,e.destroyNodeArr=[],e.activeNodeArr=[],e.currentGroundIndex=0,e}return i(e,t),e.prototype.start=function(){this.speed=r.default.SPEED_PLAYER_NORMAL/this.speed,this.canvasWidth=s.default.Instance.CanvasWidth,this.currentMode=this.City_Decor,this.spawnNewDecor(),setTimeout(function(){},3e3)},e.prototype.update=function(t){if(!s.default.Instance.IsPause()){for(var e=this.speed*t*1,n=0,i=this.activeNodeArr;n<i.length;n++){(c=i[n]).x-=e,c.x<-c.width/2-this.canvasWidth/2&&(c.x+=this.activeNodeArr.length*c.width)}for(var o=0,r=this.destroyNodeArr;o<r.length;o++){var c;(c=r[o]).x-=e,c.x<-c.width/2-this.canvasWidth/2&&(this.destroyNodeArr.splice(this.destroyNodeArr.indexOf(c),1),c.destroy())}}},e.prototype.spawnNewDecor=function(t){void 0===t&&(t=0),this.currentMode=this.currentMode==this.Desert_Decor?this.City_Decor:this.Desert_Decor;for(var e=0,n=-1,i=0==t?-this.canvasWidth/2:t;e<this.canvasWidth+this.currentMode[0].data.width;){n++;var o=cc.instantiate(this.currentMode[this.currentGroundIndex]);this.node.addChild(o),this.activeNodeArr.push(o),o.setPosition(new cc.Vec2(i+(n+.5)*o.width,0)),e+=o.width,this.currentGroundIndex=this.currentGroundIndex>=this.currentMode.length-1?0:this.currentGroundIndex+1}},e.prototype.changeBackground=function(){console.log("move"),this.currentGroundIndex=0;for(var t=this.getLastPos(),e=this.activeNodeArr.length,n=0;n<e;n++)this.destroyNodeArr.push(this.activeNodeArr.shift());this.spawnNewDecor(this.spawnMixBg(t))},e.prototype.spawnMixBg=function(t){console.log("spawnnnn");var e=cc.instantiate(this.Mix_Decor);return this.node.addChild(e),this.destroyNodeArr.push(e),e.setPosition(new cc.Vec2(t+.5*e.width,0)),e.x+e.width/2},e.prototype.getLastPos=function(){if(0==this.activeNodeArr.length)return null;for(var t=this.activeNodeArr[0],e=0;e<this.activeNodeArr.length;e++)0!=e&&this.activeNodeArr[e].position.x>this.activeNodeArr[e-1].position.x&&(t=this.activeNodeArr[e]);return t.x+t.width/2},o([u(Number)],e.prototype,"speed",void 0),o([u([cc.Prefab])],e.prototype,"Desert_Decor",void 0),o([u([cc.Prefab])],e.prototype,"City_Decor",void 0),o([u(cc.Prefab)],e.prototype,"Mix_Decor",void 0),e=o([h],e)}(c.default());n.default=p,cc._RF.pop()},{"../utils/SingletonNode":"SingletonNode","./GameDefine":"GameDefine","./GameMgr":"GameMgr"}],ObjectMgr:[function(t,e,n){"use strict";cc._RF.push(e,"dbc77ws+sxPlY9zPANdJYTf","ObjectMgr");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.load=function(t,e){},e.prototype.init=function(){this.hide()},e.prototype.hide=function(){for(var t=0,e=this.node.children;t<e.length;t++){e[t].active=!1}},e.prototype.spawn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.getAvailable=function(){for(var t=0,e=this.node.children;t<e.length;t++){var n=e[t];if(!n.active)return n}return null},e=o([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],Outline:[function(t,e,n){"use strict";cc._RF.push(e,"636b4uwYLRBmosJ5T9wVXtW","Outline");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=r.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return i(e,t),e.prototype.start=function(){},o([c(cc.Label)],e.prototype,"label",void 0),o([c],e.prototype,"text",void 0),e=o([s],e)}(cc.Component);n.default=a,cc._RF.pop()},{}],PlayerSkill:[function(t,e,n){"use strict";cc._RF.push(e,"dbad1AR4ydNyrHl16mrdz0L","PlayerSkill");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./SkillDefine"),s=t("./Player"),c=t("./GameDefine"),a=cc._decorator,h=a.ccclass,u=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.player=null,e.skillEquipment=[],e.isUsingSkill=!1,e.timerUseSkill=0,e.SKILL_TYPE={FREEZE:0,SLOW:1,RAGE:2,INVISIBLE:3},e.currentSkill=0,e.currentATK=0,e}return i(e,t),e.prototype.createSkill=function(t){switch(t){case this.SKILL_TYPE.FREEZE:case this.SKILL_TYPE.SLOW:case this.SKILL_TYPE.RAGE:case this.SKILL_TYPE.INVISIBLE:}this.skillEquipment.push(new r.default)},e.prototype.setSkill=function(t){switch(t){case this.SKILL_TYPE.FREEZE:case this.SKILL_TYPE.SLOW:case this.SKILL_TYPE.RAGE:case this.SKILL_TYPE.INVISIBLE:}},e.prototype.useSkill=function(t,e){if(!this.isUsingSkill){switch(this.isUsingSkill=!0,this.currentSkill=parseInt(e),this.currentSkill){case this.SKILL_TYPE.FREEZE:this.timerUseSkill=c.default.FREEZE;break;case this.SKILL_TYPE.SLOW:this.timerUseSkill=c.default.SLOW;break;case this.SKILL_TYPE.RAGE:this.timerUseSkill=c.default.RAGE,this.currentATK=this.player.currentATK,this.player.increaATK(this.currentATK/2);break;case this.SKILL_TYPE.INVISIBLE:this.timerUseSkill=c.default.INVISIBLE}setTimeout(this.resetKill.bind(this),1e3*this.timerUseSkill)}},e.prototype.resetKill=function(){switch(this.isUsingSkill=!1,this.currentSkill){case this.SKILL_TYPE.FREEZE:case this.SKILL_TYPE.SLOW:break;case this.SKILL_TYPE.RAGE:this.player.increaATK(-this.currentATK/2);break;case this.SKILL_TYPE.INVISIBLE:}},e.prototype.start=function(){this.player=this.getComponent(s.default)},e=o([h],e)}(cc.Component));n.default=u,cc._RF.pop()},{"./GameDefine":"GameDefine","./Player":"Player","./SkillDefine":"SkillDefine"}],Player:[function(t,e,n){"use strict";cc._RF.push(e,"366c1NVdE9GVItePcrG9zck","Player");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameMgr"),s=t("./GameDefine"),c=t("./VoiceInput"),a=t("./UIManager"),h=t("./Enemy"),u=t("./Item"),p=t("./ScreenManager"),d=t("./EnemyMgr"),l=cc._decorator,f=l.ccclass,y=l.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.UIMetter=null,e.UI_HP_BAR=null,e.UI_HP_BAR_FILL=null,e.UI_HP_BAR_HP=null,e.Spine=null,e.currentATK=s.default.PLAYER_BASE_ATK,e.mHp=s.default.PLAYER_BASE_HP,e.mCurrentExp=0,e.mCurrentLV=0,e.mRunningPos=null,e.mIsStart=!1,e.mInitHP=0,e._acc=new cc.Vec2(0,0),e._time=0,e.isUsingVoice=!1,e.isUsingBooster=!1,e.rigidBody=null,e.STATE={NOTHING:0,RUNNING:1,TAKEOFF:2,FLY:3,DROP:4},e._mState=0,e.currentTrack=null,e.animSet={Idle:"Idle_Animation",Run:"Run_Animation",Be_Attacked:"Be_attacked",Die:"Die_Animation",Fly_Loop:"Fly_Loop_Animation",Jum_up:"Jump_up_Animation",Jum_down:"Jump_down_Animation"},e.currentAnim=e.animSet.Idle,e.isAttacked=!1,e}return i(e,t),Object.defineProperty(e.prototype,"IsUsingVoice",{get:function(){return this.isUsingVoice},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsUsingBooster",{get:function(){return this.isUsingBooster},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.mRunningPos=this.node.position,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.VoiceInput=new c.default,this.VoiceInput.GetMicPermission()},e.prototype.setCompleteAnimEvent=function(){var t=this;this.Spine&&this.Spine.setCompleteListener(function(e,n){if(t.currentTrack==e)switch(e.animation?e.animation.name:""){case t.animSet.Idle:break;case t.animSet.Be_Attacked:t.setAnim(t.animSet.Run);break;case t.animSet.Run:break;case t.animSet.Jum_up:t.setAnim(t.animSet.Fly_Loop);break;case t.animSet.Fly_Loop:case t.animSet.Jum_down:case t.animSet.Die:}})},e.prototype.setAnim=function(t,e){if(void 0===e&&(e=null),this.Spine){var n=!1;switch(t){case this.animSet.Idle:n=!0;break;case this.animSet.Be_Attacked:break;case this.animSet.Run:if(this.currentAnim==t)return;n=!0;break;case this.animSet.Jum_up:break;case this.animSet.Fly_Loop:n=!0;break;case this.animSet.Jum_down:this.setAnim(this.animSet.Run);break;case this.animSet.Die:}this.Spine.setMix(this.currentAnim,t,.6),this.currentTrack=this.Spine.setAnimation(0,t,n),this.currentAnim=t}},e.prototype.onKeyUp=function(t){switch(t.keyCode){case cc.macro.KEY.space:console.log("akjlsfhksjdf"),this.rigidBody.applyForceToCenter(new cc.Vec2(0,1e6),!1)}},e.prototype.onCollisionEnter=function(t,e){if("Water"==t.node.group)this.die(!0);else if("Enemy"==t.node.group){if(t.getComponent(h.default).type==d.EnemyTypes.OWL)return;var n=t.getComponent(h.default);this.reduceHP(n.atk),n.setAttack()}else"Item"==t.node.group&&t.getComponent(u.default).useItem()},e.prototype.start=function(){this.rigidBody=this.getComponent(cc.RigidBody),this.init(),a.default.Instance.updateExp(this.mCurrentExp,s.default.LV_UP_PARAM[this.mCurrentLV+1].requireExp),cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION,this.onDeviceMotionEvent,this),this.setCompleteAnimEvent(),this.setState(this.STATE.NOTHING)},e.prototype.init=function(){this.reset(),this.setAnim(this.animSet.Idle)},e.prototype.play=function(){this.setState(this.STATE.RUNNING)},e.prototype.setVoice=function(t){this.isUsingVoice=t},e.prototype.replay=function(){this.isUsingBooster=!1,this.node.setPosition(this.mRunningPos.x,this.mRunningPos.y+100),this.reset(),this.setState(this.STATE.RUNNING)},e.prototype.increaHP=function(t){void 0===t&&(t=1),this.mHp+=t},e.prototype.useBooster=function(t){this.isUsingBooster=!0,t?this.increaHP(10):this.increaATK(10),this.updateUI()},e.prototype.reduceHP=function(t){void 0===t&&(t=0),this.isAttacked||(cc.audioEngine.play(r.default.Instance.playerBeAttacked,!1,r.default.Instance.volume),this.isAttacked=!0,this.mHp-=t,this.mHp<=0?(this.die(),this.setAnim(this.animSet.Die)):this.createBlink(5),this.updateUI())},e.prototype.createBlink=function(t){var e=this,n=0;this.Spine.node.color=cc.color("#F7A5A5");var i=setInterval(function(){n++,e.Spine.node.color=n%2==1?cc.color("#FFFFFF"):cc.color("#F7A5A5"),n==t&&(e.Spine.node.color=cc.color("#FFFFFF"),e.isAttacked=!1,clearInterval(i))},200)},e.prototype.killEnemy=function(t,e){void 0===e&&(e=0),this.mCurrentExp+=t,this.mCurrentLV<=s.default.PLAYER_MAX_LV&&this.mCurrentExp>=s.default.LV_UP_PARAM[this.mCurrentLV+1].requireExp&&(this.mCurrentLV++,this.mCurrentExp=s.default.LV_UP_PARAM[this.mCurrentLV].requireExp-this.mCurrentExp,this.currentATK=s.default.LV_UP_PARAM[this.mCurrentLV].atk),a.default.Instance.updateExp(this.mCurrentExp,s.default.LV_UP_PARAM[this.mCurrentLV+1].requireExp),this.updateUI()},e.prototype.updateUI=function(){a.default.Instance.updateATK(this.currentATK),this.updateUIHP()},e.prototype.updateUIHP=function(){this.mHp=Math.floor(10*this.mHp)/10;var t=(this.mInitHP-Math.min(this.mInitHP,this.mHp))*this.UI_HP_BAR_FILL.width/this.mInitHP;this.UI_HP_BAR_FILL.children[0].setPosition(new cc.Vec3(-t,0,0)),this.UI_HP_BAR_HP.string=this.mHp+" / "+this.mInitHP},e.prototype.increaATK=function(t){void 0===t&&(t=1),this.currentATK+=t,this.updateUI()},e.prototype.reset=function(){this.mHp=s.default.PLAYER_BASE_HP,this.mInitHP=this.mHp,this.currentATK=s.default.PLAYER_BASE_ATK,this.UI_HP_BAR_FILL.active=!0,this.UI_HP_BAR.active=!0,this.currentAnim=this.animSet.Idle,this.isAttacked=!1,this.rigidBody.gravityScale=s.default.GRAVITY_DOWN,this.updateUI()},e.prototype.killLantern=function(){Math.random()>.5?this.increaATK():this.increaHP(),this.updateUIHP()},e.prototype.die=function(t){void 0===t&&(t=!1),this.mHp=0,this.updateUI(),t&&(this.node.active=!1),r.default.Instance.endGame(),this.UI_HP_BAR_FILL.active=!1,this.UI_HP_BAR.active=!1},e.prototype.setState=function(t){switch(this._mState=t,this._mState){case this.STATE.NOTHING:this.UIMetter.active=!1;break;case this.STATE.RUNNING:this.rigidBody.type=cc.RigidBodyType.Dynamic,this.UIMetter.active=!1,this.setAnim(this.animSet.Run);break;case this.STATE.TAKEOFF:this.rigidBody.type=cc.RigidBodyType.Dynamic,this.setAnim(this.animSet.Jum_up),this.isUsingVoice||this.onOpenShake(!0),this.rigidBody.gravityScale=s.default.GRAVITY_DOWN,this.UIMetter.active=!0;break;case this.STATE.DROP:this.setAnim(this.animSet.Jum_down),this.rigidBody.gravityScale=s.default.GRAVITY_DOWN,this.rigidBody.linearVelocity=new cc.Vec2,this.UIMetter.active=!1;break;case this.STATE.FLY:this.UIMetter.active=!1}},e.prototype.onOpenShake=function(t){t||(this._acc.x=0,this._acc.y=0,this._time=0),cc.systemEvent.setAccelerometerEnabled(t)},e.prototype.onDestroy=function(){cc.systemEvent.setAccelerometerEnabled(!1),cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION,this.onDeviceMotionEvent,this)},e.prototype.onDeviceMotionEvent=function(t){this._acc.x=t.acc.x,this._acc.y=t.acc.y},e.prototype.update=function(t){if(!r.default.Instance.IsPause())switch(this._mState){case this.STATE.NOTHING:break;case this.STATE.RUNNING:if(r.default.Instance.Ground.getWaterToDrop()<this.node.x)break;var e=r.default.Instance.Ground.getWaterToFly();e&&e-r.default.Instance.CanvasWidth/5<this.node.x&&this.setState(this.STATE.TAKEOFF);break;case this.STATE.TAKEOFF:var n=s.default.GRAVITY_DOWN;if(this.VoiceInput&&this.isUsingVoice)Math.round(1e4*this.VoiceInput.GetVolume())/1e4>.3&&(this.rigidBody.linearVelocity.y<0&&(this.rigidBody.linearVelocity=new cc.Vec2),n=-s.default.GRAVITY_UP),this.updateUIMetter(Math.round(10*this.VoiceInput.GetVolume())/10);else this.isUsingVoice||this._acc.y>0&&(this.rigidBody.linearVelocity.y<0&&(this.rigidBody.linearVelocity=new cc.Vec2),n=-s.default.GRAVITY_UP);this.rigidBody.gravityScale=1*n,this.node.y>r.default.Instance.CanvasHeight*s.default.PLAYER_MAX_JUMP_HEIGHT/100&&(this.node.y=r.default.Instance.CanvasHeight*s.default.PLAYER_MAX_JUMP_HEIGHT/100,this.rigidBody.linearVelocity=new cc.Vec2);var i=r.default.Instance.Ground.getWaterToFly();i&&i<this.node.x&&this.setState(this.STATE.FLY);break;case this.STATE.FLY:n=s.default.GRAVITY_DOWN;if(this.VoiceInput&&this.isUsingVoice)Math.round(1e4*this.VoiceInput.GetVolume())/1e4>.3&&(this.rigidBody.linearVelocity.y<0&&(this.rigidBody.linearVelocity=new cc.Vec2),n=-s.default.GRAVITY_UP),this.updateUIMetter(Math.round(10*this.VoiceInput.GetVolume())/10);else this.isUsingVoice||this._acc.y>0&&(this.rigidBody.linearVelocity.y<0&&(this.rigidBody.linearVelocity=new cc.Vec2),n=-s.default.GRAVITY_UP);this.rigidBody.gravityScale=1*n,this.node.y>r.default.Instance.CanvasHeight*s.default.PLAYER_MAX_JUMP_HEIGHT/100&&(this.node.y=r.default.Instance.CanvasHeight*s.default.PLAYER_MAX_JUMP_HEIGHT/100,this.rigidBody.linearVelocity=new cc.Vec2);var o=r.default.Instance.Ground.getWaterToDrop()+30;null!=o&&o<=this.node.x&&this.setState(this.STATE.DROP),this.checkFly();break;case this.STATE.DROP:var c=-s.default.PLAYER_DROP_DOWN_SPEED*r.default.Instance.CanvasHeight/100;if(this.node.setPosition(this.node.position.add(new cc.Vec3(0,c*t,0))),this.node.y<=this.mRunningPos.y){this.node.y=this.mRunningPos.y,this.setState(this.STATE.RUNNING);r.default.Instance.LevelMgr.enemyArr[0].x,this.node.x,s.default.SPEED_PLAYER_NORMAL;p.default.Instance.ShowEnemiesComming(2.5)}}},e.prototype.checkFly=function(){},e.prototype.updateUIMetter=function(t){var e=this.UIMetter.height;this.UIMetter.children[1].y=(t-.5)*e},o([y(cc.Node)],e.prototype,"UIMetter",void 0),o([y(cc.Node)],e.prototype,"UI_HP_BAR",void 0),o([y(cc.Node)],e.prototype,"UI_HP_BAR_FILL",void 0),o([y(cc.Label)],e.prototype,"UI_HP_BAR_HP",void 0),o([y(sp.Skeleton)],e.prototype,"Spine",void 0),e=o([f],e)}(cc.Component);n.default=_,cc._RF.pop()},{"./Enemy":"Enemy","./EnemyMgr":"EnemyMgr","./GameDefine":"GameDefine","./GameMgr":"GameMgr","./Item":"Item","./ScreenManager":"ScreenManager","./UIManager":"UIManager","./VoiceInput":"VoiceInput"}],ScreenManager:[function(t,e,n){"use strict";cc._RF.push(e,"f52fdMi/MxMmq2SneTOyrbn","ScreenManager");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../utils/SingletonNode"),s=t("../utils/Timer"),c=t("./GameMgr"),a=cc._decorator,h=a.ccclass,u=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Oops=null,e.selectMode=null,e.selectModeIOS=null,e.waterComming=null,e.enemiesComming=null,e.endGame=null,e.booster=null,e.noVoice=null,e.buySticks=null,e.leaderBoard=null,e.history=null,e.collection=null,e.store=null,e.GG=null,e.isBoughtHp=!1,e.isBoughtAtk=!1,e.countDown=null,e.isShowingPopup=!1,e.STATE={NOTHING:0,SHOW_END_GAME:1,SHOW_SELECT_MODE:2,SHOW_WATER_COMMING:3,SHOW_OOPS:4,SHOW_ENEMIES_COMMING:5,SHOW_BOOSTER_PACK:6,SHOW_BUY_STICK:7,SHOW_LEADERBOARD:8,SHOW_HISTORY:9,SHOW_COLLECTION:10,SHOW_STORE:11,SHOW_GG:12},e.mState=0,e.mPreviousState=0,e}return i(e,t),e.prototype.start=function(){this.resetAll(),this.countDown=new s.default;var t=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g);this.selectMode=t?this.selectModeIOS:this.selectMode},e.prototype.setState=function(t){var e=this;switch(this.mState=t,this.mState){case this.STATE.NOTHING:break;case this.STATE.SHOW_END_GAME:this.endGame.active=!0;break;case this.STATE.SHOW_OOPS:this.Oops.active=!0;break;case this.STATE.SHOW_BOOSTER_PACK:this.booster.active=!0;break;case this.STATE.SHOW_BUY_STICK:this.buySticks.active=!0;break;case this.STATE.SHOW_SELECT_MODE:this.selectMode.active=!0;break;case this.STATE.SHOW_ENEMIES_COMMING:this.enemiesComming.children[1].children[5].getComponent(cc.Label).string="WAVE - "+c.default.Instance.LevelMgr.waveCount,this.enemiesComming.active=!0;break;case this.STATE.SHOW_WATER_COMMING:setTimeout(function(){e.waterComming.active=!0},1e3),this.waterComming.children[1].children[2].active=c.default.Instance.Player.IsUsingVoice,this.waterComming.children[1].children[3].active=!c.default.Instance.Player.IsUsingVoice;break;case this.STATE.SHOW_LEADERBOARD:this.leaderBoard.active=!0;break;case this.STATE.SHOW_HISTORY:this.history.active=!0;break;case this.STATE.SHOW_COLLECTION:this.collection.active=!0;break;case this.STATE.SHOW_STORE:this.store.active=!0;break;case this.STATE.SHOW_GG:this.GG.active=!0}},e.prototype.ShowOops=function(){this.countDown.SetDuration(5),this.setState(this.STATE.SHOW_OOPS)},e.prototype.ShowWaterComming=function(t){this.countDown.SetDuration(t),this.setState(this.STATE.SHOW_WATER_COMMING)},e.prototype.ShowHowToPlay=function(){this.setState(this.STATE.SHOW_SELECT_MODE)},e.prototype.ShowBooster=function(){this.setState(this.STATE.SHOW_BOOSTER_PACK)},e.prototype.ShowEnemiesComming=function(t){this.countDown.SetDuration(t),this.setState(this.STATE.SHOW_ENEMIES_COMMING)},e.prototype.ShowEndGame=function(){this.setState(this.STATE.SHOW_END_GAME)},e.prototype.ShowOtherScreen=function(t,e){if(!this.isShowingPopup){this.isShowingPopup=!0,this.mPreviousState=this.mState;var n=this.STATE.SHOW_LEADERBOARD;switch(e){case"history":n=this.STATE.SHOW_HISTORY;break;case"gg":n=this.STATE.SHOW_GG;break;case"store":n=this.STATE.SHOW_STORE;break;case"collection":n=this.STATE.SHOW_COLLECTION}this.resetAll(),this.setState(n)}},e.prototype.ShowBuySticks=function(){this.mPreviousState=this.mState,this.resetAll(),this.setState(this.STATE.SHOW_BUY_STICK)},e.prototype.ShowConfirm=function(){this.buySticks.children[2].active=!0},e.prototype.ConfirmBuyStick=function(t,e){parseInt(e),this.buySticks.children[2].active=!1,this.HideBuyStick()},e.prototype.HideBuyStick=function(){this.mPreviousState==this.mState&&(this.mPreviousState=this.STATE.NOTHING),this.isShowingPopup=!1,this.resetAll(),this.setState(this.mPreviousState)},e.prototype.SelectMode=function(t,e){1!=parseInt(e)||c.default.Instance.Player.VoiceInput.GotMicPermission()?(c.default.Instance.Player.setVoice(1==parseInt(e)),this.noVoice.active=!1,this.resetAll(),this.ShowBooster()):this.noVoice.active=!0},e.prototype.BuyHP=function(){this.isBoughtHp||(this.isBoughtHp=!0,c.default.Instance.Player.useBooster(!0))},e.prototype.BuyATK=function(){this.isBoughtAtk||(this.isBoughtAtk=!0,c.default.Instance.Player.useBooster(!1))},e.prototype.CloseBooster=function(){this.resetAll(),this.ShowEnemiesComming(3.5)},e.prototype.resetAll=function(t,e){void 0===t&&(t=null),void 0===e&&(e=0);for(var n=0,i=this.node.children;n<i.length;n++){i[n].active=!1}1!=e&&this.setState(this.STATE.NOTHING)},e.prototype.update=function(t){switch(this.mState){case this.STATE.NOTHING:case this.STATE.SHOW_END_GAME:case this.STATE.SHOW_SELECT_MODE:break;case this.STATE.SHOW_OOPS:this.countDown.Update(t),this.updateUIOops(),this.countDown.IsDone()&&this.ShowEndGame();break;case this.STATE.SHOW_ENEMIES_COMMING:this.countDown.Update(t),this.updateUIEnemyCountDown(),this.countDown.IsDone()&&(c.default.Instance.StartGame(),this.resetAll());break;case this.STATE.SHOW_WATER_COMMING:this.countDown.Update(t),this.updateUIWaterCountDown(),this.countDown.IsDone()&&this.resetAll()}},e.prototype.updateUIWaterCountDown=function(){this.waterComming.children[2].getComponent(cc.Label).string=""+Math.round(this.countDown.GetTime())},e.prototype.updateUIEnemyCountDown=function(){this.enemiesComming.children[1].children[4].getComponent(cc.Label).string=""+Math.round(this.countDown.GetTime())},e.prototype.updateUIOops=function(){this.Oops.children[1].children[4].getComponent(cc.Label).string=""+Math.round(this.countDown.GetTime())},o([u(cc.Node)],e.prototype,"Oops",void 0),o([u(cc.Node)],e.prototype,"selectMode",void 0),o([u(cc.Node)],e.prototype,"selectModeIOS",void 0),o([u(cc.Node)],e.prototype,"waterComming",void 0),o([u(cc.Node)],e.prototype,"enemiesComming",void 0),o([u(cc.Node)],e.prototype,"endGame",void 0),o([u(cc.Node)],e.prototype,"booster",void 0),o([u(cc.Node)],e.prototype,"noVoice",void 0),o([u(cc.Node)],e.prototype,"buySticks",void 0),o([u(cc.Node)],e.prototype,"leaderBoard",void 0),o([u(cc.Node)],e.prototype,"history",void 0),o([u(cc.Node)],e.prototype,"collection",void 0),o([u(cc.Node)],e.prototype,"store",void 0),o([u(cc.Node)],e.prototype,"GG",void 0),e=o([h],e)}(r.default());n.default=p,cc._RF.pop()},{"../utils/SingletonNode":"SingletonNode","../utils/Timer":"Timer","./GameMgr":"GameMgr"}],SingletonNode:[function(t,e,n){"use strict";cc._RF.push(e,"005153jN7pCg4dYKrYXehlc","SingletonNode");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){if(e.instance)throw e.instance.constructor.name+" instance already exist";e.instance=this},e}(cc.Component)},cc._RF.pop()},{}],Singleton:[function(t,e,n){"use strict";cc._RF.push(e,"d05d9m5rI9IA7eX1WXQ8VpM","Singleton"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){return function(){function t(){if(t.instance)throw t.instance.constructor.name+" instance already exist";t.instance=this}return Object.defineProperty(t,"Instance",{get:function(){return this.instance},enumerable:!1,configurable:!0}),t}()},cc._RF.pop()},{}],SkillDefine:[function(t,e,n){"use strict";cc._RF.push(e,"3459b7q2DFGw4tpl7Ptk3nC","SkillDefine");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){},e=o([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],StageMgr:[function(t,e,n){"use strict";cc._RF.push(e,"e1caf5/T5hCS5DBKE6D2GUy","StageMgr");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0}),n.Stages=void 0;var r,s=t("./Stage"),c=t("../utils/SingletonNode"),a=t("../utils/Helper"),h=cc._decorator,u=h.ccclass,p=h.property;(function(t){t[t.StageInterstitial=0]="StageInterstitial",t[t.StageGame=1]="StageGame"})(r=n.Stages||(n.Stages={}));var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.StagePrefabs=[],e.StageCover=null,e.mPreviousStage=null,e.mCurrentStage=null,e}return i(e,t),Object.defineProperty(e.prototype,"CurrentStage",{get:function(){return this.mCurrentStage},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){t.prototype.onLoad.call(this);for(var e=0;e<this.StagePrefabs.length;e++){var n=cc.instantiate(this.StagePrefabs[e]);this.node.addChild(n),n.active=!1}},e.prototype.start=function(){this.StageCover.active=!1,this.show(r.StageInterstitial)},e.prototype.show=function(t,e){void 0===e&&(e=.5),this.mPreviousStage=this.mCurrentStage;for(var n=0,i=this.node.children;n<i.length;n++){var o=i[n],c=o.name==a.default.GetKeyEnum(r,t);c&&(this.mCurrentStage=o),o.active!=c&&(o.active=c)}this.mPreviousStage&&this.mCurrentStage&&this.mPreviousStage!=this.mCurrentStage?this.animate(e):this.mCurrentStage.getComponent(s.default).init()},e.prototype.nextStage=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=.5);var n=this.node.children.indexOf(this.mCurrentStage);t||0!=n?-1!=n&&(t&&n<this.node.childrenCount-1||!t&&n>0)&&(n=t?n+1:n-1,this.show(a.default.GetIndexEnum(r,this.node.children[n].name),e)):window.location=""},e.prototype.animate=function(t){var e=this;this.mPreviousStage.active=!0,this.mCurrentStage.active=!1,this.StageCover.active=!0,cc.tween(this.mPreviousStage).to(t,{scale:this.mPreviousStage.scaleX},{progress:function(t,n,i,o){return e.StageCover.opacity=255*o,t+(n-t)*o}}).call(function(){e.mPreviousStage.active=!1,e.mCurrentStage.active=!0,e.mCurrentStage.getComponent(s.default).init()}).start(),cc.tween(this.mCurrentStage).delay(t).to(t,{scale:this.mCurrentStage.scaleX},{progress:function(t,n,i,o){return e.StageCover.opacity=255*(1-o),t+(n-t)*o}}).call(function(){e.StageCover.active=!1}).start()},o([p(cc.Prefab)],e.prototype,"StagePrefabs",void 0),e=o([u],e)}(c.default());n.default=d,cc._RF.pop()},{"../utils/Helper":"Helper","../utils/SingletonNode":"SingletonNode","./Stage":"Stage"}],Stage:[function(t,e,n){"use strict";cc._RF.push(e,"8285cHcekVM+LuqNIhGaIT5","Stage");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.init=function(){},e=o([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],Timer:[function(t,e,n){"use strict";cc._RF.push(e,"2f2fcQ9soJHUbtX80Hsh3jj","Timer"),Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(){this.timer=0,this.duration=0,this.overhead=0,this.isDone=!0}return t.prototype.SetDuration=function(t){this.timer=t,this.duration=t,this.overhead=0,this.isDone=!1},t.prototype.GetDuration=function(){return this.duration},t.prototype.GetTime=function(){return this.timer},t.prototype.GetPercent=function(){return this.timer/this.duration},t.prototype.Reset=function(){this.timer=this.duration,this.overhead=0,this.isDone=!1},t.prototype.IsDone=function(){return 0===this.timer},t.prototype.FirstFinished=function(){return!(this.timer>0)&&(!this.isDone&&(this.isDone=!0,!0))},t.prototype.GetOverhead=function(){return this.overhead},t.prototype.Update=function(t){0!==this.timer&&(this.timer-=t,this.timer<0&&(this.overhead=-this.timer,this.timer=0))},t}();n.default=i,cc._RF.pop()},{}],UIManager:[function(t,e,n){"use strict";cc._RF.push(e,"1285bwloupNG6Xi08T9eHTl","UIManager");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../utils/SingletonNode"),s=cc._decorator,c=s.ccclass,a=s.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.UI_HP=null,e.UI_WAVE=null,e.UI_DAME=null,e.UI_SCORE_TEXT=null,e.UI_EXP_FILL=null,e.UI_EXP_TEXT=null,e.UI_WHITE_NUMBER_SMALL=[],e.UI_RED_NUMBER_SMALL=[],e.UI_ORGANGE_NUMBER=[],e.UI_RED_NUMBER_BIG=[],e}return i(e,t),e.prototype.start=function(){},e.prototype.updateHP=function(t,e){var n=this;void 0===t&&(t=1),void 0===e&&(e=!1),e?this.addEffect(this.UI_HP,function(){n.UI_HP.children[0].getComponent(cc.Label).string=": "+t}):this.UI_HP.children[0].getComponent(cc.Label).string=": "+t},e.prototype.updateATK=function(t,e){var n=this;void 0===t&&(t=1),void 0===e&&(e=!1),e?this.addEffect(this.UI_DAME,function(){n.UI_DAME.children[0].getComponent(cc.Label).string=""+t}):this.UI_DAME.children[0].getComponent(cc.Label).string=""+t},e.prototype.updateWave=function(t,e){var n=this;void 0===t&&(t=1),void 0===e&&(e=!1),e?this.addEffect(this.UI_WAVE,function(){n.UI_WAVE.getComponent(cc.Label).string=""+t}):this.UI_WAVE.getComponent(cc.Label).string=""+t},e.prototype.updateScore=function(t){this.UI_SCORE_TEXT.string=""+t},e.prototype.updateExp=function(t,e){var n=t/e*this.UI_EXP_FILL.width;this.UI_EXP_FILL.x=-this.UI_EXP_FILL.width+n,this.UI_EXP_TEXT.string=t+" / "+e},e.prototype.addEffect=function(t,e){cc.tween(t).to(.5,{scale:1.5},{easing:"sineOut"}).call(e).to(.5,{scale:1},{easing:"sineOut"}).start()},o([a(cc.Node)],e.prototype,"UI_HP",void 0),o([a(cc.Node)],e.prototype,"UI_WAVE",void 0),o([a(cc.Node)],e.prototype,"UI_DAME",void 0),o([a(cc.Label)],e.prototype,"UI_SCORE_TEXT",void 0),o([a(cc.Node)],e.prototype,"UI_EXP_FILL",void 0),o([a(cc.Label)],e.prototype,"UI_EXP_TEXT",void 0),o([a([cc.SpriteFrame])],e.prototype,"UI_WHITE_NUMBER_SMALL",void 0),o([a([cc.SpriteFrame])],e.prototype,"UI_RED_NUMBER_SMALL",void 0),o([a([cc.SpriteFrame])],e.prototype,"UI_ORGANGE_NUMBER",void 0),o([a([cc.SpriteFrame])],e.prototype,"UI_RED_NUMBER_BIG",void 0),e=o([c],e)}(r.default());n.default=h,cc._RF.pop()},{"../utils/SingletonNode":"SingletonNode"}],VoiceInput:[function(t,e,n){"use strict";cc._RF.push(e,"3ccac1X+jREDob6WX8kIUEN","VoiceInput");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=t("../lib/volume-meter"),r=t("../utils/Singleton"),s=t("./GameDefine"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.audioContext=null,e.mediaStreamSource=null,e.meter=null,e.gotMicPermission=!1,e.warningMsg="",e}return i(e,t),e.prototype.GetMicPermission=function(t){var e=this;void 0===t&&(t=null),void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise(function(n,i){e.call(navigator,t,n,i)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))});try{navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(n){e.OnGetStreamSuccess(n,t)}).catch(function(n){e.OnGetStreamFail(n),t&&t(!1)})}catch(e){this.OnGetStreamFail(e),t&&t(!1)}},e.prototype.GetVolume=function(){if(!this.GotMicPermission())return 0;var t=this.meter.volume*s.default.VOLUME_VOICE_INPUT_AMPLIFIER;return t=Math.min(1,t)},e.prototype.GotMicPermission=function(){return this.gotMicPermission},e.prototype.GetWarningMessage=function(){return this.warningMsg},e.prototype.OnGetStreamSuccess=function(t,e){var n=this;try{var i=window.AudioContext||window.webkitAudioContext;this.gotMicPermission=!0,this.audioContext=new i,this.mediaStreamSource=this.audioContext.createMediaStreamSource(t),this.meter=o.createAudioMeter(this.audioContext),this.mediaStreamSource.connect(this.meter),this.audioContext&&this.audioContext.resume();var r=!1,s=setInterval(function(){n.GetVolume()>0&&(r=!0,clearInterval(s),e&&e(!0))},1e3/60);setTimeout(function(){r||(clearInterval(s),e&&e(!1))},2e3)}catch(t){this.warningMsg="Fail create audio meter "+t,e&&e(!1)}},e.prototype.OnGetStreamFail=function(t){this.warningMsg="Fail getting user media "+t},e}(r.default());n.default=c,cc._RF.pop()},{"../lib/volume-meter":"volume-meter","../utils/Singleton":"Singleton","./GameDefine":"GameDefine"}],WaveDefine:[function(t,e,n){"use strict";cc._RF.push(e,"af276Z1sTVIe7DrZP78ZF8m","WaveDefine");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,s=r.ccclass,c=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){},e.prototype.update=function(t){0==this.node.children.length&&this.node.destroy()},e=o([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],"copy-to-clipboard":[function(t,e,n){(function(i){"use strict";cc._RF.push(e,"46d62f7lmxLtYrCe6tYpBfJ","copy-to-clipboard"),function(t){"object"==typeof n&&void 0!==e?e.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:void 0!==i?i:"undefined"!=typeof self?self:this).copyToClipboard=t()}(function(){return function e(n,i,o){function r(c,a){if(!i[c]){if(!n[c]){var h="function"==typeof t&&t;if(!a&&h)return h(c,!0);if(s)return s(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var p=i[c]={exports:{}};n[c][0].call(p.exports,function(t){return r(n[c][1][t]||t)},p,p.exports,e,n,i,o)}return i[c].exports}for(var s="function"==typeof t&&t,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(t,e,n){var i=t("toggle-selection");e.exports=function(t,e){var n,o,r,s,c,a,h=!1;e||(e={}),n=e.debug||!1;try{if(r=i(),s=document.createRange(),c=document.getSelection(),(a=document.createElement("span")).textContent=t,a.style.all="unset",a.style.position="fixed",a.style.top=0,a.style.clip="rect(0, 0, 0, 0)",a.style.whiteSpace="pre",a.style.webkitUserSelect="text",a.style.MozUserSelect="text",a.style.msUserSelect="text",a.style.userSelect="text",document.body.appendChild(a),s.selectNode(a),c.addRange(s),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");h=!0}catch(i){n&&console.error("unable to copy using execCommand: ",i),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",t),h=!0}catch(i){n&&console.error("unable to copy using clipboardData: ",i),n&&console.error("falling back to prompt"),o=function(t){var e=(/mac os x/i.test(navigator.userAgent)?"\xe2\u0152\u02dc":"Ctrl")+"+C";return t.replace(/#{\s*key\s*}/g,e)}("message"in e?e.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,t)}}finally{c&&("function"==typeof c.removeRange?c.removeRange(s):c.removeAllRanges()),a&&document.body.removeChild(a),r()}return h}},{"toggle-selection":2}],2:[function(t,e,n){e.exports=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,n=[],i=0;i<t.rangeCount;i++)n.push(t.getRangeAt(i));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null}return t.removeAllRanges(),function(){"Caret"===t.type&&t.removeAllRanges(),t.rangeCount||n.forEach(function(e){t.addRange(e)}),e&&e.focus()}}},{}]},{},[1])(1)}),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],preload:[function(t,e,n){"use strict";cc._RF.push(e,"a402bVvulBOBr9eMBhvDgLa","preload");var i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__decorate||function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};Object.defineProperty(n,"__esModule",{value:!0});var r=t("./GameMgr"),s=t("./ScreenManager"),c=cc._decorator,a=c.ccclass,h=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ingame=null,e.isGameStarted=!1,e}return i(e,t),e.prototype.start=function(){},e.prototype.startGame=function(){var t=this;s.default.Instance.isShowingPopup||this.isGameStarted||(this.isGameStarted=!0,this.Ingame.active=!0,setTimeout(function(){cc.tween(t.node).to(1,{opacity:0}).call(function(){t.node.active=!1}).start()},300),r.default.Instance.EnterGame())},o([h(cc.Node)],e.prototype,"Ingame",void 0),e=o([a],e)}(cc.Component);n.default=u,cc._RF.pop()},{"./GameMgr":"GameMgr","./ScreenManager":"ScreenManager"}],shake:[function(t,e,n){"use strict";cc._RF.push(e,"791d3Rs4ktE+7iJ1Q43NtGZ","shake"),function(t,n){"function"==typeof define&&define.amd?define(function(){return n(t,t.document)}):void 0!==e&&e.exports?e.exports=n(t,t.document):t.Shake=n(t,t.document)}("undefined"!=typeof window?window:void 0,function(t,e){function n(n){if(this.hasDeviceMotion="ondevicemotion"in t||"deviceorientation"in t,this.options={threshold:15,timeout:1e3},"object"==typeof n)for(var i in n)n.hasOwnProperty(i)&&(this.options[i]=n[i]);if(this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof e.CustomEvent)this.event=new e.CustomEvent("shake",{bubbles:!0,cancelable:!0});else{if("function"!=typeof e.createEvent)return!1;this.event=e.createEvent("Event"),this.event.initEvent("shake",!0,!0)}}return n.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},n.prototype.start=function(){this.reset(),t.DeviceOrientationEvent?t.addEventListener("deviceorientation",this,!1):t.DeviceMotionEvent?t.addEventListener("devicemotion",this,!1):t.addEventListener("MozOrientation",this,!1)},n.prototype.stop=function(){t.DeviceOrientationEvent?t.removeEventListener("deviceorientation",this,!1):t.DeviceMotionEvent?t.removeEventListener("devicemotion",this,!1):t.removeEventListener("MozOrientation",this,!1),this.reset()},n.prototype.deviceorientation=function(e){var n,i,o,r=e;if(null===this.lastX&&null===this.lastY&&null===this.lastZ)return this.lastX=2*r.gamma,this.lastY=2*r.beta,void(this.lastZ=2*r.alpha);n=Math.abs(this.lastX-2*r.gamma),i=Math.abs(this.lastY-2*r.beta),o=Math.abs(this.lastZ-2*r.alpha),(n>this.options.threshold&&i>this.options.threshold||n>this.options.threshold&&o>this.options.threshold||i>this.options.threshold&&o>this.options.threshold)&&(new Date).getTime()-this.lastTime.getTime()>this.options.timeout&&(t.dispatchEvent(this.event),this.lastTime=new Date),this.lastX=2*r.gamma,this.lastY=2*r.beta,this.lastZ=2*r.alpha},n.prototype.devicemotion=function(e){var n,i,o,r=e.accelerationIncludingGravity;if(null===this.lastX&&null===this.lastY&&null===this.lastZ)return this.lastX=1*r.z,this.lastY=1*r.y,void(this.lastZ=1*r.x);n=Math.abs(this.lastX-1*r.z),i=Math.abs(this.lastY-1*r.y),o=Math.abs(this.lastZ-1*r.x),(n>this.options.threshold&&i>this.options.threshold||n>this.options.threshold&&o>this.options.threshold||i>this.options.threshold&&o>this.options.threshold)&&(new Date).getTime()-this.lastTime.getTime()>this.options.timeout&&(t.dispatchEvent(this.event),this.lastTime=new Date),this.lastX=1*r.z,this.lastY=1*r.y,this.lastZ=1*r.x},n.prototype.handleEvent=function(t){if("function"==typeof this[t.type])return this[t.type](t)},n}),cc._RF.pop()},{}],"volume-meter":[function(t,e,n){"use strict";function i(t){for(var e,n=t.inputBuffer.getChannelData(0),i=n.length,o=0,r=0;r<i;r++)e=n[r],Math.abs(e)>=this.clipLevel&&(this.clipping=!0,this.lastClip=window.performance.now()),o+=e*e;var s=Math.sqrt(o/i);this.volume=Math.max(s,this.volume*this.averaging)}cc._RF.push(e,"ad54dBNHAVOCLKMrpeYb4+r","volume-meter"),n.__esModule=!0,n.createAudioMeter=function(t,e,n,o){var r=t.createScriptProcessor(512);return r.onaudioprocess=i,r.clipping=!1,r.lastClip=0,r.volume=0,r.clipLevel=e||.98,r.averaging=n||.95,r.clipLag=o||750,r.connect(t.destination),r.checkClipping=function(){return!!this.clipping&&(this.lastClip+this.clipLag<window.performance.now()&&(this.clipping=!1),this.clipping)},r.shutdown=function(){this.disconnect(),this.onaudioprocess=null},r},cc._RF.pop()},{}]},{},["AudioManager","BGLoop","BackgroundFade","Bg","BigBg","Decoration","Effect","Enemy","EnemyDefine","EnemyMgr","Enviroment","EnviromentManager","GameDefine","GameMgr","Ground","Item","LevelMgr","MiddleGround","Outline","Player","PlayerSkill","ScreenManager","SkillDefine","UIManager","VoiceInput","WaveDefine","preload","shake","copy-to-clipboard","volume-meter","Stage","StageMgr","GameObject","Helper","ObjectMgr","Singleton","SingletonNode","Timer"]);